<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‰‹æœºä¸»å±å¹•</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
            background: linear-gradient(135deg, #1a1a1a, #000);
            color: #fff;
            height: 100vh;
            overflow: hidden;
        }

        .phone {
            height: 100vh;
            display: flex;
            flex-direction: column;
            position: relative;
            overflow: hidden;
        }

        /* çŠ¶æ€æ æ ·å¼ */
        .status-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 15px;
            height: 44px;
            background-color: rgba(0, 0, 0, 0);
            color: white;
            font-size: 16px;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
        }

        .status-left, .status-center, .status-right {
            display: flex;
            align-items: center;
        }

        .status-left {
            flex: 1;
        }

        .status-center {
            flex: 2;
            justify-content: center;
        }

        .status-right {
            flex: 1;
            justify-content: flex-end;
        }

        .status-icon {
            width: 18px;
            height: 18px;
            margin: 0 5px;
        }

        /* åç‰‡å°ç»„ä»¶æ ·å¼ */
        .profile-widget {
            position: absolute;
            bottom: 140px;
            left: 25px;
            width: 160px;
            background: transparent;
            border-radius: 20px;
            padding: 15px;
            text-align: center;
            z-index: 998;
        }

        .profile-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: #333;
            margin: 0 auto 15px;
            cursor: pointer;
            overflow: hidden;
            border: 2px solid white;
        }

        .profile-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
        }

        .profile-avatar:hover {
            opacity: 0.8;
        }

        .profile-nickname {
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            padding: 5px;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .profile-nickname:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .profile-signature {
            font-size: 12px;
            color: #aaa;
            cursor: pointer;
            min-height: 20px;
            padding: 5px;
            border-radius: 10px;
        }

        .profile-signature:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        /* å¤©æ°”ä¿¡æ¯ç»„ä»¶æ ·å¼ */
        .weather-widget {
            position: absolute;
            top: 60px;
            left: 25px;
            width: calc(50% - 30px);
            background: rgba(255, 255, 255, 0.01);
            border-radius: 20px;
            padding: 15px;
            z-index: 996;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .weather-location {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #fff;
        }

        .weather-icon {
            width: 60px;
            height: 60px;
            margin: 0 auto 10px;
        }

        /* æ™´å¤©å›¾æ ‡åŠ¨ç”» */
        .sunny-icon {
            animation: sunAnimation 3s ease-in-out infinite;
        }

        @keyframes sunAnimation {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-5px) rotate(5deg); }
        }

        /* é›¨å¤©å›¾æ ‡åŠ¨ç”» */
        .rainy-icon {
            animation: rainAnimation 2s linear infinite;
        }

        @keyframes rainAnimation {
            0% { transform: translateY(-10px); }
            100% { transform: translateY(10px); }
        }

        /* é˜´å¤©å›¾æ ‡åŠ¨ç”» */
        .cloudy-icon {
            animation: cloudAnimation 4s ease-in-out infinite;
        }

        @keyframes cloudAnimation {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(5px); }
        }

        /* é›ªå¤©å›¾æ ‡åŠ¨ç”» */
        .snowy-icon {
            animation: snowAnimation 4s linear infinite;
        }

        @keyframes snowAnimation {
            0% { transform: translateY(-5px) rotate(0deg); }
            100% { transform: translateY(5px) rotate(360deg); }
        }

        /* å¤šäº‘è½¬é˜´å›¾æ ‡åŠ¨ç”» */
        .partly-cloudy-icon {
            animation: partlyCloudyAnimation 3s ease-in-out infinite;
        }

        @keyframes partlyCloudyAnimation {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* é›¨å¤¹é›ªå›¾æ ‡åŠ¨ç”» */
        .sleet-icon {
            animation: sleetAnimation 2s ease-in-out infinite;
        }

        @keyframes sleetAnimation {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-3px); }
        }

        .weather-temp {
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 5px;
            color: #fff;
        }

        .weather-day {
            font-size: 14px;
            text-align: center;
            margin-bottom: 5px;
            color: #aaa;
        }

        .weather-date {
            font-size: 14px;
            text-align: center;
            color: #aaa;
        }

        .weather-description {
            font-size: 14px;
            text-align: center;
            margin-bottom: 5px;
            color: #aaa;
        }

        /* ç…§ç‰‡å±•ç¤ºç»„ä»¶æ ·å¼ */
        .photo-display-widget {
            position: absolute;
            top: 46px;
            right: 16px;
            width: calc(50% - 10px);
            background: transparent; /* ç§»é™¤èƒŒæ™¯ */
            border-radius: 20px;
            padding: 15px;
            z-index: 996;
            cursor: pointer;
            transition: transform 0.2s ease;
            height: 276px; /* è°ƒæ•´é«˜åº¦ä»¥åŒ¹é…å¤©æ°”ç»„ä»¶(åŒ…æ‹¬padding) */
        }

        .photo-display-widget:hover {
            transform: scale(1.02);
        }

        .photo-display-container {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            border-radius: 10px;
        }

        .photo-display-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: 10px;
        }

        .photo-display-placeholder img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
            border-radius: 10px;
        }

        /* æ—‹è½¬åŠ¨ç”»ç±» */
        .rotating {
            animation: rotate 20s linear infinite;
            animation-play-state: paused;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .rotating.playing {
            animation-play-state: running;
        }

        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* ä¸“è¾‘å°é¢å ä½ç¬¦ */
        .rotating .placeholder {
            font-size: 24px;
            color: rgba(255, 255, 255, 0.5);
        }

        /* ä¸“è¾‘å°é¢å›¾ç‰‡ */
        .rotating img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
        }

        .photo-icon {
            font-size: 30px;
            margin-bottom: 10px;
        }

        .photo-text {
            font-size: 14px;
            color: #aaa;
        }

        /* æ»‘åŠ¨é¡µé¢å®¹å™¨ */
        .pages-container {
            width: 100%;
            height: 100%;
            position: relative;
            overflow: hidden; /* éšè—è¶…å‡ºéƒ¨åˆ† */
        }

        .page {
            width: 100%;
            height: 100%;
            position: absolute; /* ä½¿ç”¨ç»å¯¹å®šä½ */
            top: 0;
            left: 0;
            padding-top: 44px; /* ä¸ºçŠ¶æ€æ ç•™å‡ºç©ºé—´ */
            padding-bottom: 0; /* ç§»é™¤åº•éƒ¨paddingï¼Œè®©home-screenè‡ªå·±å¤„ç† */
            transition: transform 0.3s ease; /* æ·»åŠ è¿‡æ¸¡æ•ˆæœ */
        }
        
        /* ç¬¬äºŒé¡µåˆå§‹ä½ç½®åœ¨å±å¹•å³ä¾§ */
        .page:nth-child(2) {
            transform: translateX(100%);
        }
        
        /* ç¬¬ä¸‰é¡µåˆå§‹ä½ç½®åœ¨å±å¹•å³ä¾§ */
        .page:nth-child(3) {
            transform: translateX(100%);
        }

        /* ä¸»å±å¹•å†…å®¹åŒºåŸŸ */
        .home-screen {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(5, 1fr);
            gap: 25px;
            padding: 56px 25px 130px 25px; /* å¢åŠ åº•éƒ¨paddingï¼Œä¸ºDockæ ç•™å‡ºè¶³å¤Ÿç©ºé—´ */
            align-content: start;
            height: 100%; /* æ”¹ä¸º100%é«˜åº¦ */
            position: relative;
            z-index: 10;
        }

        .app-icon {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: transform 0.2s;
            position: relative;
        }

        .app-icon.dragging {
            opacity: 0.5;
            transform: scale(1.1);
            z-index: 1000;
        }

        .app-icon .icon-bg {
            width: 65px;
            height: 65px;
            border-radius: 18px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .app-icon .icon-bg svg {
            width: 35px;
            height: 35px;
        }

        .app-icon span {
            font-size: 13px;
            text-align: center;
            text-shadow: 0 1px 2px rgba(0, 0, 0, 0.5);
        }

        .app-icon:hover {
            transform: scale(1.1);
        }

        /* Dockæ æ ·å¼ */
        .dock {
            height: 100px;
            display: flex;
            justify-content: center;
            align-items: center;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            padding: 15px;
            position: fixed;
            bottom: 25px; /* è°ƒæ•´ä½ç½®ï¼Œé¿å…ä¸ä¸»å±å¹•å›¾æ ‡é‡å  */
            left: 50%;
            transform: translateX(-50%);
            border-radius: 30px;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.15);
            z-index: 999;
        }

        .dock .app-icon {
            margin: 0 10px;
        }

        .dock .app-icon .icon-bg {
            width: 70px;
            height: 70px;
            border-radius: 20px;
        }

        .dock .app-icon .icon-bg svg {
            width: 40px;
            height: 40px;
        }

        /* éšè—æ–‡ä»¶è¾“å…¥æ¡† */
        .hidden-file-input {
            display: none;
        }

        /* è‡ªå®šä¹‰å¼¹çª—æ ·å¼ */
        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }

        .modal.active {
            opacity: 1;
            visibility: visible;
        }

        .modal-content {
            background: rgba(30, 30, 30, 0.95);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 25px;
            width: 90%;
            max-width: 350px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transform: translateY(20px);
            transition: transform 0.3s ease;
        }

        .modal.active .modal-content {
            transform: translateY(0);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 18px;
            font-weight: bold;
        }

        .close-btn {
            background: transparent;
            border: none;
            color: white;
            font-size: 24px;
            cursor: pointer;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }

        .close-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-size: 14px;
            color: #aaa;
        }

        .form-input {
            width: 100%;
            padding: 12px 15px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.1);
            color: white;
            font-size: 16px;
            box-sizing: border-box;
        }

        .form-input:focus {
            outline: none;
            border-color: rgba(0, 122, 255, 0.5);
            background: rgba(255, 255, 255, 0.15);
        }

        /* æœç´¢ç»“æœé¡¹æ ·å¼ */
        .search-result-item {
            padding: 10px;
            cursor: pointer;
            border-bottom: 1px solid rgba(255,255,255,0.1);
            transition: background-color 0.2s;
        }

        .search-result-item:hover {
            background-color: rgba(255, 255, 255, 0.1);
        }

        .search-result-item:last-child {
            border-bottom: none;
        }

        .upload-area {
            border: 2px dashed rgba(255, 255, 255, 0.2);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            margin-bottom: 20px;
            transition: all 0.3s;
        }

        .upload-area:hover {
            border-color: rgba(0, 122, 255, 0.5);
            background: rgba(0, 122, 255, 0.05);
        }

        .upload-icon {
            font-size: 40px;
            margin-bottom: 10px;
        }

        .upload-text {
            font-size: 14px;
            color: #aaa;
        }

        .submit-btn {
            width: 100%;
            padding: 15px;
            border-radius: 12px;
            background: linear-gradient(45deg, #007AFF, #0A84FF);
            border: none;
            color: white;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
        }

        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(10, 132, 255, 0.4);
        }

        .submit-btn:disabled {
            background: #666;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        /* æ‹–æ‹½å ä½ç¬¦ */
        .drag-placeholder {
            width: 65px;
            height: 65px;
            border: 2px dashed rgba(255, 255, 255, 0.5);
            border-radius: 18px;
            margin-bottom: 8px;
        }

        /* å£çº¸æ ·å¼ */
        .wallpaper {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-size: cover;
            background-position: center;
            z-index: -1;
            opacity: 1;
        }
        
        /* è§†é¢‘å£çº¸æ ·å¼ */
        .wallpaper video {
            width: 100%;
            height: 100%;
            object-fit: cover;
            position: absolute;
            top: 0;
            left: 0;
            z-index: -1;
        }

        /* éŸ³ä¹æ’­æ”¾å™¨å°ç»„ä»¶ */
        .music-player {
            position: absolute;
            top: 320px;  /* è¿˜åŸåŸæ¥çš„ä½ç½® */
            left: 25px;
            width: calc(100% - 50px);
            background: rgba(255, 255, 255, 0.01);
            border-radius: 20px;
            padding: 10px;
            z-index: 997;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
        }

        /* è¯­éŸ³ç»„ä»¶æ ·å¼ */
        .voice-component {
            position: absolute;
            top: 585px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 350px;
            height: 60px;
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 30px;
            display: flex;
            align-items: center;
            padding: 0 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            z-index: 100;
        }

        /* æµªæ¼«å¿ƒè·³ç»„ä»¶æ ·å¼ */
        .romantic-heartbeat-widget {
            position: absolute;
            top: 60px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            max-width: 350px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            padding: 20px;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            z-index: 20;
        }
        
        .heartbeat-container {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 30px;
        }
        
        .avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            z-index: 2;
            border: 2px solid rgba(255, 255, 255, 0.3);
            cursor: pointer;
        }
        
        .avatar-img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            overflow: hidden;
        }
        
        .avatar-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
        }
        
        .avatar-placeholder {
            font-size: 30px;
            line-height: 60px;
        }
        
        .heartbeat-area {
            flex: 1;
            height: 100px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .heart-icon {
            width: 50px;
            height: 50px;
            animation: heartbeat 1.2s ease-in-out infinite;
            position: relative;
            z-index: 3;
        }
        
        .heart-icon svg {
            width: 100%;
            height: 100%;
        }
        
        @keyframes heartbeat {
            0% { transform: scale(1); }
            5% { transform: scale(1.1); }
            10% { transform: scale(1); }
            15% { transform: scale(1.2); }
            50% { transform: scale(1); }
            100% { transform: scale(1); }
        }
        
        /* åˆ›å»ºçˆ±å¿ƒå½¢çŠ¶çš„å‘å…‰æ•ˆæœ */
        .heart-icon::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url("data:image/svg+xml,%3Csvg viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M12 21.35L10.55 20.03C5.4 15.36 2 12.28 2 8.5C2 5.42 4.42 3 7.5 3C9.24 3 10.91 3.81 12 5.09C13.09 3.81 14.76 3 16.5 3C19.58 3 22 5.42 22 8.5C22 12.28 18.6 15.36 13.45 20.04L12 21.35Z' fill='red'/%3E%3C/svg%3E") center/contain no-repeat;
            z-index: -1;
            animation: pulse 1.2s ease-in-out infinite;
            filter: blur(15px);
            opacity: 0.7;
        }
        
        /* åˆ›å»ºå¿ƒç”µå›¾è„‰å†²æŠ˜çº¿æ•ˆæœ */
        .ecg-line {
            position: absolute;
            width: 100%;
            height: 60px;
            top: 50%;
            transform: translateY(-50%);
            overflow: hidden;
        }
        
        /* ä½¿ç”¨SVGåˆ›å»ºå¿ƒç”µå›¾æŠ˜çº¿ */
        .ecg-line::after {
            content: '';
            position: absolute;
            width: 200%;
            height: 100%;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 60'%3E%3Cpath d='M0,30 L20,30 L30,10 L40,50 L50,30 L70,30 L80,15 L90,45 L100,30 L120,30 L130,20 L140,40 L150,30 L170,30 L180,25 L190,35 L200,30' stroke='red' stroke-width='2' fill='none' stroke-dasharray='1000' stroke-dashoffset='1000'%3E%3Canimate attributeName='stroke-dashoffset' from='1000' to='0' dur='2s' repeatCount='indefinite'/%3E%3C/path%3E%3C/svg%3E");
            background-repeat: repeat-x;
            animation: ecgMove 2s linear infinite;
            filter: drop-shadow(0 0 4px rgba(255, 0, 0, 0.7));
        }
        
        @keyframes ecgMove {
            0% { transform: translateX(0); }
            100% { transform: translateX(-100px); }
        }
        
        /* å¿ƒè·³åŠ¨ç”»å¢å¼º */
        @keyframes pulse {
            0% { 
                transform: scale(1);
                opacity: 0.7;
            }
            50% { 
                transform: scale(1.8);
                opacity: 0.4;
            }
            100% { 
                transform: scale(1);
                opacity: 0.7;
            }
        }
        
        /* ä¼šä¸€ç›´åœ¨ä¸€èµ·æ–‡å­—æ ·å¼ */
        .together-text {
            text-align: center;
            font-size: 16px;
            color: #fff;
            margin-bottom: 20px;
            font-weight: bold;
        }
        
        /* å¤©æ•°æ˜¾ç¤ºåŒºåŸŸæ ·å¼ */
        .days-display {
            text-align: center;
            padding: 15px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .days-display:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .days-count {
            font-size: 18px;
            font-weight: bold;
            color: #fff;
            text-shadow: 0 0 10px rgba(255, 255, 255, 0.8);
        }
        
        /* å‘å…‰æ•ˆæœ */
        .glow {
            animation: glow 1.5s ease-in-out infinite alternate;
        }
        
        @keyframes glow {
            from {
                text-shadow: 0 0 5px #fff, 0 0 10px #fff, 0 0 15px #e60073, 0 0 20px #e60073;
            }
            to {
                text-shadow: 0 0 10px #fff, 0 0 20px #fff, 0 0 30px #ff4da6, 0 0 40px #ff4da6;
            }
        }
        
        .star-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-left: 10px;
            cursor: pointer;
        }
        
        .voice-wave {
            flex: 1;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .wave-bar {
            width: 3px;
            height: 10px;
            background: rgba(255, 255, 255, 0.6);
            margin: 0 2px;
            border-radius: 2px;
            animation: waveAnimation 1s infinite ease-in-out;
        }
        
        .wave-bar:nth-child(2) {
            animation-delay: 0.1s;
            height: 15px;
        }
        
        .wave-bar:nth-child(3) {
            animation-delay: 0.2s;
            height: 20px;
        }
        
        .wave-bar:nth-child(4) {
            animation-delay: 0.3s;
            height: 25px;
        }
        
        .wave-bar:nth-child(5) {
            animation-delay: 0.4s;
            height: 20px;
        }
        
        .wave-bar:nth-child(6) {
            animation-delay: 0.5s;
            height: 15px;
        }
        
        .wave-bar:nth-child(7) {
            animation-delay: 0.6s;
            height: 10px;
        }
        
        @keyframes waveAnimation {
            0%, 100% {
                transform: scaleY(1);
            }
            50% {
                transform: scaleY(1.5);
            }
        }

        .album-cover {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            overflow: hidden;
            margin-right: 15px;
            flex-shrink: 0;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255, 255, 255, 0.1);
        }

        .album-cover .placeholder {
            font-size: 30px;
            color: rgba(255, 255, 255, 0.5);
        }

        .album-cover img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
        }

        /* éŸ³ä¹ä¿¡æ¯ */
        .music-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-width: 0;
            position: relative;
        }

        .voice-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 10px;
            cursor: pointer;
            overflow: hidden;
        }
        
        .voice-avatar .avatar-img {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            overflow: hidden;
        }
        
        .voice-avatar .avatar-img img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
        }
        
        .voice-avatar .avatar-placeholder {
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }
        
        .song-info {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
            width: 100%;
        }

        .song-name {
            font-size: 14px;
            font-weight: bold;
            margin-right: 8px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            flex: 1;
            min-width: 0;
        }

        .favorite-btn {
            width: 24px;
            height: 24px;
            background: transparent;
            border: none;
            cursor: pointer;
            padding: 0;
            flex-shrink: 0;
            position: absolute;
            top: 0;
            right: 0;
            filter: drop-shadow(0 0 4px rgba(255, 59, 48, 0.3));
        }

        .favorite-btn.active {
            filter: drop-shadow(0 0 8px rgba(255, 59, 48, 0.8));
        }

        .favorite-btn svg {
            width: 100%;
            height: 100%;
            fill: #fff;
        }

        .favorite-btn.active svg {
            fill: #ff3b30;
        }

        .artist-name {
            font-size: 12px;
            color: #aaa;
            margin-bottom: 10px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* æ§åˆ¶æŒ‰é’® */
        .control-buttons {
            display: flex;
            align-items: center;
            justify-content: space-between;
            width: 100%;
        }

        .control-btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            flex-shrink: 0;
        }

        .control-btn svg {
            width: 16px;
            height: 16px;
            fill: white;
        }

        .play-btn {
            width: 40px;
            height: 40px;
        }

        .play-btn svg {
            width: 20px;
            height: 20px;
        }
        
        /* æ–°å¢å°ç»„ä»¶æ ·å¼ */
        .custom-widget {
            position: absolute;
            top: 60px;
            left: 20px;
            width: calc(100% - 40px);
            background: rgba(255, 255, 255, 0.05); /* ç»ç’ƒé€æ˜èƒŒæ™¯ */
            border-radius: 20px;
            padding: 15px;
            backdrop-filter: blur(0px); /* ä¸æ¨¡ç³Šå£çº¸ */
            -webkit-backdrop-filter: blur(0px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            z-index: 20;
            transform: translateX(0);
            height: calc(53% - 30px); /* è°ƒæ•´é«˜åº¦ï¼Œåªè¦†ç›–å‰å‡ è¡Œï¼Œä¸ºæ™ºèƒ½ä½“åº”ç”¨ç•™å‡ºçº¦10pxç©ºé—´ */
        }
        
        /* å°ç»„ä»¶æ—¶é—´æ ·å¼ */
        .widget-time {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            color: #fff;
            margin-bottom: 15px;
        }
        
        /* çˆ±å¿ƒæ°”æ³¡æ ·å¼ */
        .love-bubble {
            background: rgba(255, 255, 255, 0.8); /* ç™½è‰²å¸¦ç‚¹ç° */
            color: #333;
            padding: 15px 20px;
            border-radius: 30px;
            margin-bottom: 20px;
            cursor: pointer;
            display: inline-block;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .love-bubble:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
        }
        
        /* ç…§ç‰‡å®¹å™¨æ ·å¼ */
        .photo-container {
            width: 100%;
            height: 180px; /* å¢åŠ ç…§ç‰‡å®¹å™¨é«˜åº¦ */
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            margin-bottom: 15px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            position: relative;
        }
        
        .photo-container img {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            object-position: center;
        }
        
        .photo-container img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center;
        }
        
        .photo-placeholder {
            text-align: center;
            color: #aaa;
            font-size: 16px;
        }
        
        /* è¾“å…¥å®¹å™¨æ ·å¼ */
        .input-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .widget-input {
            flex: 1;
            padding: 12px 15px;
            border-radius: 20px;
            background: rgba(255, 255, 255, 0.8); /* å’Œæ°”æ³¡é¢œè‰²ç›¸åŒ */
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: #333;
            font-size: 16px;
            outline: none;
        }
        
        .widget-input::placeholder {
            color: #999;
        }
        
        .send-btn, .add-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%; /* åœ†å½¢æŒ‰é’® */
            background: #8B4513; /* è¤è‰²èƒŒæ™¯ */
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .send-btn:hover, .add-btn:hover {
            background: #A0522D; /* æ·±ä¸€ç‚¹çš„è¤è‰² */
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <!-- å£çº¸ -->
    <div class="wallpaper" id="wallpaper"></div>
    
    <!-- éšè—çš„éŸ³é¢‘æ’­æ”¾å™¨ -->
    <audio id="audioPlayer" style="display: none;"></audio>
    
    <div class="phone">
        <!-- çŠ¶æ€æ  -->
        <div class="status-bar">
            <div class="status-left">
                <span class="time" id="current-time">00:00</span>
            </div>
            <div class="status-center">
                <!-- ä¸­é—´ç•™ç©º -->
            </div>
            <div class="status-right">
                <!-- ä¿¡å·å›¾æ ‡ -->
                <svg class="status-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M5 17L5 12" stroke="white" stroke-width="2" stroke-linecap="round"/>
                    <path d="M12 17L12 7" stroke="white" stroke-width="2" stroke-linecap="round"/>
                    <path d="M19 17L19 2" stroke="white" stroke-width="2" stroke-linecap="round"/>
                </svg>
                <!-- ç”µæ± å›¾æ ‡ -->
                <svg class="status-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <rect x="2" y="7" width="16" height="10" rx="3" stroke="white" stroke-width="2"/>
                    <path d="M20 10V14" stroke="white" stroke-width="2" stroke-linecap="round"/>
                    <rect x="4" y="9" width="12" height="6" rx="2" fill="white"/>
                </svg>
            </div>
        </div>

        <!-- æ»‘åŠ¨é¡µé¢å®¹å™¨ -->
        <div class="pages-container" id="pagesContainer">
            <!-- ç¬¬ä¸€é¡µ -->
            <div class="page" id="page1">
                <!-- åç‰‡å°ç»„ä»¶ -->
                <div class="profile-widget">
                    <div class="profile-avatar" id="profileAvatar" onclick="changeAvatar()">
                        <span style="font-size: 30px; line-height: 60px;">ğŸ‘¤</span>
                    </div>
                    <div class="profile-nickname" id="profileNickname" onclick="changeNickname()">ç‚¹å‡»è®¾ç½®æ˜µç§°</div>
                    <div class="profile-signature" id="profileSignature" onclick="changeSignature()">ç‚¹å‡»è®¾ç½®ä¸ªæ€§ç­¾å</div>
                </div>

                <!-- å¤©æ°”ä¿¡æ¯ç»„ä»¶ -->
                <div class="weather-widget" onclick="openWeatherModal()">
                    <div class="weather-location" id="weatherLocation">åŒ—äº¬</div>
                    <div class="weather-icon">
                        <!-- æ™´å¤©å›¾æ ‡ -->
                        <svg class="sunny-icon" id="sunnyIcon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="display: none;">
                            <circle cx="12" cy="12" r="4" fill="#FFD700" stroke="#FFA500" stroke-width="1.5"/>
                            <path d="M12 3V1" stroke="#FFA500" stroke-width="2" stroke-linecap="round"/>
                            <path d="M12 23V21" stroke="#FFA500" stroke-width="2" stroke-linecap="round"/>
                            <path d="M3 12H1" stroke="#FFA500" stroke-width="2" stroke-linecap="round"/>
                            <path d="M23 12H21" stroke="#FFA500" stroke-width="2" stroke-linecap="round"/>
                            <path d="M5.64 5.64L4.22 4.22" stroke="#FFA500" stroke-width="2" stroke-linecap="round"/>
                            <path d="M19.78 19.78L18.36 18.36" stroke="#FFA500" stroke-width="2" stroke-linecap="round"/>
                            <path d="M5.64 18.36L4.22 19.78" stroke="#FFA500" stroke-width="2" stroke-linecap="round"/>
                            <path d="M19.78 4.22L18.36 5.64" stroke="#FFA500" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                        
                        <!-- é›¨å¤©å›¾æ ‡ -->
                        <svg class="rainy-icon" id="rainyIcon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="display: none;">
                            <path d="M6 14C4.34315 14 3 15.3431 3 17C3 18.6569 4.34315 20 6 20H16C17.6569 20 19 18.6569 19 17C19 15.3431 17.6569 14 16 14H6Z" fill="#87CEEB"/>
                            <path d="M8 16C6.34315 16 5 17.3431 5 19C5 20.6569 6.34315 22 8 22H14C15.6569 22 17 20.6569 17 19C17 17.3431 15.6569 16 14 16H8Z" fill="#87CEEB"/>
                            <!-- é›¨æ»´1 -->
                            <path d="M9 18L9 20" stroke="#4682B4" stroke-width="1.5" stroke-linecap="round">
                                <animate attributeName="opacity" values="0;1;0" dur="1s" repeatCount="indefinite" begin="0s"/>
                                <animate attributeName="y" values="16;22" dur="1s" repeatCount="indefinite" begin="0s"/>
                            </path>
                            <!-- é›¨æ»´2 -->
                            <path d="M12 18L12 20" stroke="#4682B4" stroke-width="1.5" stroke-linecap="round">
                                <animate attributeName="opacity" values="0;1;0" dur="1s" repeatCount="indefinite" begin="0.3s"/>
                                <animate attributeName="y" values="16;22" dur="1s" repeatCount="indefinite" begin="0.3s"/>
                            </path>
                            <!-- é›¨æ»´3 -->
                            <path d="M15 18L15 20" stroke="#4682B4" stroke-width="1.5" stroke-linecap="round">
                                <animate attributeName="opacity" values="0;1;0" dur="1s" repeatCount="indefinite" begin="0.6s"/>
                                <animate attributeName="y" values="16;22" dur="1s" repeatCount="indefinite" begin="0.6s"/>
                            </path>
                        </svg>
                        
                        <!-- é˜´å¤©å›¾æ ‡ -->
                        <svg class="cloudy-icon" id="cloudyIcon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="display: none;">
                            <path d="M6 14C4.34315 14 3 15.3431 3 17C3 18.6569 4.34315 20 6 20H16C17.6569 20 19 18.6569 19 17C19 15.3431 17.6569 14 16 14H6Z" fill="#C0C0C0"/>
                            <path d="M8 16C6.34315 16 5 17.3431 5 19C5 20.6569 6.34315 22 8 22H14C15.6569 22 17 20.6569 17 19C17 17.3431 15.6569 16 14 16H8Z" fill="#C0C0C0"/>
                        </svg>
                        
                        <!-- é›ªå¤©å›¾æ ‡ -->
                        <svg class="snowy-icon" id="snowyIcon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="display: none;">
                            <path d="M6 14C4.34315 14 3 15.3431 3 17C3 18.6569 4.34315 20 6 20H16C17.6569 20 19 18.6569 19 17C19 15.3431 17.6569 14 16 14H6Z" fill="#87CEEB"/>
                            <path d="M8 16C6.34315 16 5 17.3431 5 19C5 20.6569 6.34315 22 8 22H14C15.6569 22 17 20.6569 17 19C17 17.3431 15.6569 16 14 16H8Z" fill="#87CEEB"/>
                            <!-- é›ªèŠ±1 -->
                            <circle cx="9" cy="18" r="1.5" fill="white">
                                <animate attributeName="opacity" values="0;1;0" dur="2s" repeatCount="indefinite" begin="0s"/>
                            </circle>
                            <!-- é›ªèŠ±2 -->
                            <circle cx="12" cy="19" r="1.5" fill="white">
                                <animate attributeName="opacity" values="0;1;0" dur="2s" repeatCount="indefinite" begin="0.5s"/>
                            </circle>
                            <!-- é›ªèŠ±3 -->
                            <circle cx="15" cy="18" r="1.5" fill="white">
                                <animate attributeName="opacity" values="0;1;0" dur="2s" repeatCount="indefinite" begin="1s"/>
                            </circle>
                        </svg>
                        
                        <!-- å¤šäº‘è½¬é˜´å›¾æ ‡ -->
                        <svg class="partly-cloudy-icon" id="partlyCloudyIcon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="display: none;">
                            <circle cx="10" cy="10" r="3" fill="#FFD700" stroke="#FFA500" stroke-width="1.5"/>
                            <path d="M10 7V5" stroke="#FFA500" stroke-width="2" stroke-linecap="round"/>
                            <path d="M6 14C4.34315 14 3 15.3431 3 17C3 18.6569 4.34315 20 6 20H16C17.6569 20 19 18.6569 19 17C19 15.3431 17.6569 14 16 14H6Z" fill="#C0C0C0"/>
                            <path d="M8 16C6.34315 16 5 17.3431 5 19C5 20.6569 6.34315 22 8 22H14C15.6569 22 17 20.6569 17 19C17 17.3431 15.6569 16 14 16H8Z" fill="#C0C0C0"/>
                        </svg>
                        
                        <!-- é›¨å¤¹é›ªå›¾æ ‡ -->
                        <svg class="sleet-icon" id="sleetIcon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="display: none;">
                            <path d="M6 14C4.34315 14 3 15.3431 3 17C3 18.6569 4.34315 20 6 20H16C17.6569 20 19 18.6569 19 17C19 15.3431 17.6569 14 16 14H6Z" fill="#87CEEB"/>
                            <path d="M8 16C6.34315 16 5 17.3431 5 19C5 20.6569 6.34315 22 8 22H14C15.6569 22 17 20.6569 17 19C17 17.3431 15.6569 16 14 16H8Z" fill="#87CEEB"/>
                            <!-- é›¨æ»´ -->
                            <path d="M9 18L9 20" stroke="#4682B4" stroke-width="1.5" stroke-linecap="round">
                                <animate attributeName="opacity" values="0;1;0" dur="1s" repeatCount="indefinite" begin="0s"/>
                                <animate attributeName="y" values="16;22" dur="1s" repeatCount="indefinite" begin="0s"/>
                            </path>
                            <!-- é›ªèŠ± -->
                            <circle cx="15" cy="18" r="1.5" fill="white">
                                <animate attributeName="opacity" values="0;1;0" dur="2s" repeatCount="indefinite" begin="0.5s"/>
                            </circle>
                        </svg>
                        
                        <!-- é»˜è®¤å›¾æ ‡ -->
                        <svg id="defaultWeatherIcon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 15C13.6569 15 15 13.6569 15 12C15 10.3431 13.6569 9 12 9C10.3431 9 9 10.3431 9 12C9 13.6569 10.3431 15 12 15Z" stroke="white" stroke-width="2"/>
                            <path d="M19.4 15C19.2667 15.2667 18.8 16.2 17.8 17.2C16.8 18.2 15.8667 18.6667 15.6 18.8" stroke="white" stroke-width="2" stroke-linecap="round"/>
                            <path d="M12 22C14.5 20.5 16 18.5 16 16C16 13.5 14.5 11.5 12 10C9.5 11.5 8 13.5 8 16C8 18.5 9.5 20.5 12 22Z" stroke="white" stroke-width="2"/>
                            <path d="M4.6 9C4.73333 8.73333 5.2 7.8 6.2 6.8C7.2 5.8 8.13333 5.33333 8.4 5.2" stroke="white" stroke-width="2" stroke-linecap="round"/>
                            <path d="M19.4 9C19.2667 8.73333 18.8 7.8 17.8 6.8C16.8 5.8 15.8667 5.33333 15.6 5.2" stroke="white" stroke-width="2" stroke-linecap="round"/>
                            <path d="M4.6 15C4.73333 15.2667 5.2 16.2 6.2 17.2C7.2 18.2 8.13333 18.6667 8.4 18.8" stroke="white" stroke-width="2" stroke-linecap="round"/>
                        </svg>
                    </div>
                    <div class="weather-temp" id="weatherTemp">25Â°C</div>
                    <div class="weather-description" id="weatherDescription">æ™´å¤©</div>
                    <div class="weather-day" id="weatherDay">æ˜ŸæœŸä¸‰</div>
                    <div class="weather-date" id="weatherDate">10æœˆ1æ—¥</div>
                </div>

                <!-- ç…§ç‰‡å±•ç¤ºç»„ä»¶ -->
                <div class="photo-display-widget" onclick="changePhotoDisplay()">
                    <div class="photo-display-container">
                        <div class="photo-display-placeholder" id="photoDisplay">
                            <span class="photo-icon">ğŸ“·</span>
                            <span class="photo-text">ç‚¹å‡»æ·»åŠ ç…§ç‰‡</span>
                        </div>
                    </div>
                </div>

                <!-- éŸ³ä¹æ’­æ”¾å™¨å°ç»„ä»¶ -->
                <div class="music-player">
                    <div class="album-cover rotating" id="albumCover" onclick="changeAlbumCover()">
                        <div class="placeholder">â™ª</div>
                    </div>
                    <div class="music-info">
                        <div class="song-info">
                            <div class="song-name" id="songName" onclick="openSongModal()">æœªçŸ¥æ­Œæ›²</div>
                        </div>
                        <button class="favorite-btn" id="favoriteBtn" onclick="toggleFavorite()">
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 21.35L10.55 20.03C5.4 15.36 2 12.28 2 8.5C2 5.42 4.42 3 7.5 3C9.24 3 10.91 3.81 12 5.09C13.09 3.81 14.76 3 16.5 3C19.58 3 22 5.42 22 8.5C22 12.28 18.6 15.36 13.45 20.04L12 21.35Z"/>
                            </svg>
                        </button>
                        <div class="artist-name" id="artistName">æœªçŸ¥è‰ºæœ¯å®¶</div>
                        <div class="control-buttons">
                            <button class="control-btn" onclick="previousSong()">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M6 6H8V18H6V6ZM9.5 12L18 6V18L9.5 12Z"/>
                                </svg>
                            </button>
                            <button class="control-btn play-btn" onclick="togglePlay()" id="playBtn">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" id="playIcon">
                                    <path d="M8 5V19L19 12L8 5Z" id="playPath"/>
                                </svg>
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" id="pauseIcon" style="display: none;">
                                    <path d="M14 19V5H18V19H14ZM6 19V5H10V19H6Z"/>
                                </svg>
                            </button>
                            <button class="control-btn" onclick="nextSong()">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M6 18L14.5 12L6 6V18ZM16 6V18H18V6H16Z"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- ä¸»å±å¹•å†…å®¹ -->
                <div class="home-screen" id="homeScreen">
                    <!-- å£çº¸åº”ç”¨å›¾æ ‡ - ç¬¬å››è¡Œç¬¬ä¸‰åˆ— -->
                    <div class="app-icon" onclick="window.location.href='bizhi.html'" data-app="å£çº¸" style="grid-column: 3; grid-row: 4;">
                        <div class="icon-bg">
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M4 16L9 11L13 15L20 8" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                <rect x="3" y="3" width="18" height="18" rx="3" stroke="white" stroke-width="2"/>
                            </svg>
                        </div>
                        <span>å£çº¸</span>
                    </div>
                    
                    <!-- è®¾ç½®åº”ç”¨å›¾æ ‡ - ç¬¬å››è¡Œç¬¬å››åˆ— -->
                    <div class="app-icon" onclick="window.location.href='shezhi.html'" data-app="è®¾ç½®" style="grid-column: 4; grid-row: 4;">
                        <div class="icon-bg">
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M21 15C21 15.5304 20.7893 16.0391 20.4142 16.4142C20.0391 16.7893 19.5304 17 19 17H7L3 21V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H19C19.5304 3 20.0391 3.21071 20.4142 3.58579C20.7893 3.96086 21 4.46957 21 5V15Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </div>
                        <span>è®¾ç½®</span>
                    </div>
                    
                    <!-- èŠå¤©åº”ç”¨å›¾æ ‡ - ç¬¬äº”è¡Œç¬¬ä¸‰åˆ— -->
                    <div class="app-icon" onclick="window.location.href='chat.html'" data-app="èŠå¤©" style="grid-column: 3; grid-row: 5; margin-bottom: 10px;">
                        <div class="icon-bg">
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M21 11.5C21.0034 12.8199 20.6951 14.1219 20.1 15.3C19.3948 16.7262 18.3522 17.9555 17.05 18.9C15.7478 19.8445 14.2199 20.4861 12.58 20.77C11.9413 20.8791 11.2916 20.9135 10.64 20.88L7 22L8.12 18.36C7.38368 17.9462 6.71624 17.4224 6.14 16.8C4.72104 15.2441 3.92829 13.2159 4 11.1C4.00344 9.78012 4.31172 8.47814 4.90685 7.30001C5.61203 5.87386 6.65462 4.64455 7.95683 3.69999C9.25903 2.75544 10.7869 2.11382 12.4269 1.82999C14.0669 1.54616 15.7757 1.62764 17.42 2.06999C19.0643 2.51234 20.5975 3.30299 21.9 4.37999C23.2025 5.45699 24.15 7.02999 24.15 8.76999C24.1491 9.55042 24.0492 10.3261 23.85 11.07L24 11L21 11.5Z" stroke="white" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" fill="none"/>
                                <path d="M8 12H8.01" stroke="white" stroke-width="3" stroke-linecap="round"/>
                                <path d="M12 12H12.01" stroke="white" stroke-width="3" stroke-linecap="round"/>
                                <path d="M16 12H16.01" stroke="white" stroke-width="3" stroke-linecap="round"/>
                            </svg>
                        </div>
                        <span>èŠå¤©</span>
                    </div>
                    
                    <!-- éŸ³ä¹åº”ç”¨å›¾æ ‡ - ç¬¬äº”è¡Œç¬¬å››åˆ— -->
                    <div class="app-icon" onclick="window.location.href='yinyue.html'" data-app="éŸ³ä¹" style="grid-column: 4; grid-row: 5; margin-bottom: 10px;">
                        <div class="icon-bg">
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M12 3V12L19 5V19L12 12V21" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </div>
                        <span>éŸ³ä¹</span>
                    </div>
                    </div>
                </div>

                <!-- ç¬¬äºŒé¡µ -->
                <div class="page" id="page2">
                    <!-- æµªæ¼«å¿ƒè·³ç»„ä»¶ -->
                    <div class="romantic-heartbeat-widget">
                        <div class="heartbeat-container">
                            <!-- å¤´åƒ1 -->
                            <div class="avatar avatar-left" onclick="changeAvatar('left')">
                                <div class="avatar-img" id="avatarLeft">
                                    <div class="avatar-placeholder">ğŸ‘¤</div>
                                </div>
                            </div>
                            
                            <!-- å¿ƒè·³åŠ¨ç”»åŒºåŸŸ -->
                            <div class="heartbeat-area">
                                <div class="heart-icon">
                                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M12 21.35L10.55 20.03C5.4 15.36 2 12.28 2 8.5C2 5.42 4.42 3 7.5 3C9.24 3 10.91 3.81 12 5.09C13.09 3.81 14.76 3 16.5 3C19.58 3 22 5.42 22 8.5C22 12.28 18.6 15.36 13.45 20.04L12 21.35Z" stroke="red" stroke-width="2" fill="red"/>
                                    </svg>
                                </div>
                                <div class="ecg-line"></div>
                            </div>
                            
                            <!-- å¤´åƒ2 -->
                            <div class="avatar avatar-right" onclick="changeAvatar('right')">
                                <div class="avatar-img" id="avatarRight">
                                    <div class="avatar-placeholder">ğŸ‘¤</div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- ä¼šä¸€ç›´åœ¨ä¸€èµ·æ–‡å­— -->
                        <div class="together-text">ä¼šä¸€ç›´åœ¨ä¸€èµ·</div>
                        
                        <!-- å¤©æ•°æ˜¾ç¤ºåŒºåŸŸ -->
                        <div class="days-display" id="daysDisplay" onclick="openDaysModal()">
                            <div class="days-count" id="daysCount">ç‚¹å‡»è®¾ç½®çºªå¿µæ—¥</div>
                        </div>
                    </div>

                    <!-- è¯­éŸ³ç»„ä»¶ï¼ˆæ–°å¢ï¼‰ -->
                    <div class="voice-component" id="voiceComponent" onclick="playVoiceAudio()">
                        <!-- å¤´åƒ -->
                        <div class="voice-avatar" onclick="changeVoiceAvatar(); event.stopPropagation();">
                            <div class="avatar-img" id="voiceAvatarContainer">
                                <img id="voiceAvatarImg" src="" alt="å¤´åƒ" style="width: 100%; height: 100%; border-radius: 50%; object-fit: cover; display: none;">
                                <div class="avatar-placeholder" id="voiceAvatarPlaceholder" style="font-size: 20px; width: 100%; height: 100%; display: flex; align-items: center; justify-content: center;">ğŸ‘¤</div>
                            </div>
                        </div>
                        
                        <!-- è¯­éŸ³æ³¢çº¹æ¡ -->
                        <div class="voice-wave" id="voiceWave">
                            <div class="wave-bar"></div>
                            <div class="wave-bar"></div>
                            <div class="wave-bar"></div>
                            <div class="wave-bar"></div>
                            <div class="wave-bar"></div>
                            <div class="wave-bar"></div>
                            <div class="wave-bar"></div>
                        </div>
                        
                        <!-- æ˜Ÿæ˜Ÿå›¾æ ‡ -->
                        <div class="star-icon" onclick="uploadVoiceAudio(); event.stopPropagation();">
                            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" style="width: 20px; height: 20px;">
                                <path d="M12 2L15.09 8.26L22 9L17 14L18.18 21L12 17.77L5.82 21L7 14L2 9L8.91 8.26L12 2Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </div>
                    </div>

                    <!-- ä¸»å±å¹•å†…å®¹ -->
                    <div class="home-screen">
                        <!-- æ—¥è®°åº”ç”¨å›¾æ ‡ - ç¬¬ä¸‰è¡Œç¬¬ä¸€åˆ— -->
                        <div class="app-icon" onclick="window.location.href='riji.html'" data-app="æ—¥è®°" style="grid-row: 3; grid-column: 1;">
                            <div class="icon-bg">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M4 19.5V4.5C4 3.5 5 2.5 6 2.5H17C18 2.5 19 3.5 19 4.5V19.5L12 16.5L4 19.5Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M9 9H15" stroke="white" stroke-width="2" stroke-linecap="round"/>
                                    <path d="M9 13H13" stroke="white" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                            </div>
                            <span>æ—¥è®°</span>
                        </div>
                        
                        <!-- è´­ç‰©åº”ç”¨å›¾æ ‡ - ç¬¬ä¸‰è¡Œç¬¬äºŒåˆ— -->
                        <div class="app-icon" onclick="alert('è´­ç‰©åº”ç”¨åŠŸèƒ½å¼€å‘ä¸­')" data-app="è´­ç‰©" style="grid-row: 3; grid-column: 2;">
                            <div class="icon-bg">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M6 2L3 6V20C3 20.5304 3.21071 21.0391 3.58579 21.4142C3.96086 21.7893 4.46957 22 5 22H19C19.5304 22 20.0391 21.7893 20.4142 21.4142C20.7893 21.0391 21 20.5304 21 20V6L18 2H6Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M3 6H21" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M16 10C16 11.0609 15.5786 12.0783 14.8284 12.8284C14.0783 13.5786 13.0609 14 12 14C10.9391 14 9.92172 13.5786 9.17157 12.8284C8.42143 12.0783 8 11.0609 8 10" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </div>
                            <span>è´­ç‰©</span>
                        </div>
                        
                        <!-- è®ºå›åº”ç”¨å›¾æ ‡ - ç¬¬ä¸‰è¡Œç¬¬ä¸‰åˆ— -->
                        <div class="app-icon" onclick="alert('è®ºå›åº”ç”¨åŠŸèƒ½å¼€å‘ä¸­')" data-app="è®ºå›" style="grid-row: 3; grid-column: 3;">
                            <div class="icon-bg">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M21 15C21 15.5304 20.7893 16.0391 20.4142 16.4142C20.0391 16.7893 19.5304 17 19 17H7L3 21V5C3 4.46957 3.21071 3.96086 3.58579 3.58579C3.96086 3.21071 4.46957 3 5 3H19C19.5304 3 20.0391 3.21071 20.4142 3.58579C20.7893 3.96086 21 4.46957 21 5V15Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M16 10H16.01" stroke="white" stroke-width="3" stroke-linecap="round"/>
                                    <path d="M12 10H12.01" stroke="white" stroke-width="3" stroke-linecap="round"/>
                                    <path d="M8 10H8.01" stroke="white" stroke-width="3" stroke-linecap="round"/>
                                </svg>
                            </div>
                            <span>è®ºå›</span>
                        </div>
                        
                        <!-- å¤‡å¿˜å½•åº”ç”¨å›¾æ ‡ - ç¬¬ä¸‰è¡Œç¬¬å››åˆ— -->
                        <div class="app-icon" onclick="alert('å¤‡å¿˜å½•åº”ç”¨åŠŸèƒ½å¼€å‘ä¸­')" data-app="å¤‡å¿˜å½•" style="grid-row: 3; grid-column: 4;">
                            <div class="icon-bg">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M4 6H20V18C20 19.1046 19.1046 20 18 20H6C4.89543 20 4 19.1046 4 18V6Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M4 10H20" stroke="white" stroke-width="2" stroke-linecap="round"/>
                                    <path d="M9 14H10" stroke="white" stroke-width="2" stroke-linecap="round"/>
                                    <path d="M9 17H12" stroke="white" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                            </div>
                            <span>å¤‡å¿˜å½•</span>
                        </div>
                        
                        <!-- é’±åŒ…åº”ç”¨å›¾æ ‡ - ç¬¬å››è¡Œç¬¬ä¸€åˆ— -->
                        <div class="app-icon" onclick="window.location.href='qianbao.html'" data-app="é’±åŒ…" style="grid-row: 4; grid-column: 1;">
                            <div class="icon-bg">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M3 7H21C21.5523 7 22 7.44772 22 8V17C22 17.5523 21.5523 18 21 18H3C2.44772 18 2 17.5523 2 17V8C2 7.44772 2.44772 7 3 7Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M2 12H4" stroke="white" stroke-width="2" stroke-linecap="round"/>
                                    <path d="M18 12C18 13.1046 17.1046 14 16 14C14.8954 14 14 13.1046 14 12C14 10.8954 14.8954 10 16 10C17.1046 10 18 10.8954 18 12Z" stroke="white" stroke-width="2"/>
                                </svg>
                            </div>
                            <span>é’±åŒ…</span>
                        </div>
                        
                        <!-- ç”µè¯åº”ç”¨å›¾æ ‡ - ç¬¬å››è¡Œç¬¬äºŒåˆ— -->
                        <div class="app-icon" onclick="window.location.href='dianhua.html'" data-app="ç”µè¯" style="grid-row: 4; grid-column: 2;">
                            <div class="icon-bg">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M3 6C3 5.44772 3.44772 5 4 5H20C20.5523 5 21 5.44772 21 6V18C21 18.5523 20.5523 19 20 19H4C3.44772 19 3 18.5523 3 18V6Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M8 7H16" stroke="white" stroke-width="2" stroke-linecap="round"/>
                                    <path d="M8 11H16" stroke="white" stroke-width="2" stroke-linecap="round"/>
                                    <path d="M8 15H13" stroke="white" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                            </div>
                            <span>ç”µè¯</span>
                        </div>
                        
                        <!-- é™ªä¼´åº”ç”¨å›¾æ ‡ - ç¬¬å››è¡Œç¬¬ä¸‰åˆ— -->
                        <div class="app-icon" onclick="alert('é™ªä¼´åº”ç”¨åŠŸèƒ½å¼€å‘ä¸­')" data-app="é™ªä¼´" style="grid-row: 4; grid-column: 3;">
                            <div class="icon-bg">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 12C14.2091 12 16 10.2091 16 8C16 5.79086 14.2091 4 12 4C9.79086 4 8 5.79086 8 8C8 10.2091 9.79086 12 12 12Z" stroke="white" stroke-width="2"/>
                                    <path d="M6 20C6 17.7909 7.79086 16 10 16H14C16.2091 16 18 17.7909 18 20V20C18 21.1046 17.1046 22 16 22H8C6.89543 22 6 21.1046 6 20V20Z" stroke="white" stroke-width="2"/>
                                </svg>
                            </div>
                            <span>é™ªä¼´</span>
                        </div>
                        
                        <!-- æŠ½å¡åº”ç”¨å›¾æ ‡ - ç¬¬å››è¡Œç¬¬å››åˆ— -->
                        <div class="app-icon" onclick="window.location.href='chouka.html'" data-app="æŠ½å¡" style="grid-row: 4; grid-column: 4;">
                            <div class="icon-bg">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M19 3H5C3.89543 3 3 3.89543 3 5V19C3 20.1046 3.89543 21 5 21H19C20.1046 21 21 20.1046 21 19V5C21 3.89543 20.1046 3 19 3Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M3 9H21" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <path d="M9 21V9" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                    <circle cx="12" cy="6" r="1" fill="white"/>
                                    <circle cx="16" cy="6" r="1" fill="white"/>
                                    <circle cx="8" cy="6" r="1" fill="white"/>
                                </svg>
                            </div>
                            <span>æŠ½å¡</span>
                        </div>
                    </div>
                </div>
                <!-- ç¬¬ä¸‰é¡µ -->
                <div class="page" id="page3">
                    <!-- æ–°å¢çš„å°ç»„ä»¶ -->
                    <div class="custom-widget">
                        <div class="widget-time" id="widgetTime">00:00</div>
                        <div class="love-bubble" id="loveBubble" onclick="changeLoveText()">I love you</div>
                        <div class="photo-container" onclick="changeWidgetPhoto()">
                            <img id="widgetPhoto" src="" alt="ç…§ç‰‡" style="display: none; max-width: 100%; max-height: 100%; object-fit: contain;">
                            <div id="photoPlaceholder" class="photo-placeholder">ğŸ“· ç‚¹å‡»æ·»åŠ ç…§ç‰‡</div>
                        </div>
                        <div class="input-container">
                            <input type="text" class="widget-input" id="widgetInput" placeholder="ç‚¹å‡»è¾“å…¥..." onclick="changeWidgetInput()">
                            <button class="send-btn" onclick="sendWidgetMessage()">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" width="20" height="20">
                                    <path d="M2 21L23 12L2 3V10L17 12L2 14V21Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                            </button>
                            <button class="add-btn" onclick="addWidgetItem()">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" width="20" height="20">
                                    <path d="M12 5V19" stroke="white" stroke-width="2" stroke-linecap="round"/>
                                    <path d="M5 12H19" stroke="white" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                            </button>
                        </div>
                    </div>
                    
                    <!-- ä¸»å±å¹•å†…å®¹ -->
                    <div class="home-screen">
                        <!-- æ™ºèƒ½ä½“åº”ç”¨å›¾æ ‡ - ç¬¬å››è¡Œç¬¬ä¸€åˆ— -->
                        <div class="app-icon" onclick="alert('æ™ºèƒ½ä½“åº”ç”¨åŠŸèƒ½å¼€å‘ä¸­')" data-app="æ™ºèƒ½ä½“" style="grid-row: 4; grid-column: 1;">
                            <div class="icon-bg">
                                <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2Z" stroke="white" stroke-width="2"/>
                                    <path d="M8 16C9.10457 16 10 15.1046 10 14C10 12.8954 9.10457 12 8 12C6.89543 12 6 12.8954 6 14C6 15.1046 6.89543 16 8 16Z" fill="white"/>
                                    <path d="M16 16C17.1046 16 18 15.1046 18 14C18 12.8954 17.1046 12 16 12C14.8954 12 14 12.8954 14 14C14 15.1046 14.8954 16 16 16Z" fill="white"/>
                                    <path d="M8 11C8 11 9.5 13 12 13C14.5 13 16 11 16 11" stroke="white" stroke-width="2" stroke-linecap="round"/>
                                </svg>
                            </div>
                            <span>æ™ºèƒ½ä½“</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dockæ  -->
        <div class="dock">
            <div class="app-icon" data-app="è§’è‰²ä¹¦" onclick="window.location.href='jueseshu.html'">
                <div class="icon-bg">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3Z" stroke="white" stroke-width="2"/>
                        <path d="M12 7V12L15 15" stroke="white" stroke-width="2" stroke-linecap="round"/>
                        <path d="M8 16C8.5 14.5 10 13.5 12 13.5C14 13.5 15.5 14.5 16 16" stroke="white" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </div>
            </div>
            <div class="app-icon" data-app="ä¸–ç•Œä¹¦" onclick="window.location.href='shijieshu.html'">
                <div class="icon-bg">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="white" stroke-width="2"/>
                        <path d="M8 3H16" stroke="white" stroke-width="2" stroke-linecap="round"/>
                        <path d="M8 21H16" stroke="white" stroke-width="2" stroke-linecap="round"/>
                        <path d="M12 2V22" stroke="white" stroke-width="2" stroke-linecap="round"/>
                        <path d="M3 12H21" stroke="white" stroke-width="2" stroke-linecap="round"/>
                        <path d="M3 8L7 8" stroke="white" stroke-width="2" stroke-linecap="round"/>
                        <path d="M3 16L7 16" stroke="white" stroke-width="2" stroke-linecap="round"/>
                        <path d="M17 8L21 8" stroke="white" stroke-width="2" stroke-linecap="round"/>
                        <path d="M17 16L21 16" stroke="white" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </div>
            </div>
            <div class="app-icon" data-app="è¯´æ˜ä¹¦" onclick="window.location.href='shuomingshu.html'">
                <div class="icon-bg">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M4 2H20C21.1046 2 22 2.89543 22 4V20C22 21.1046 21.1046 22 20 22H4C2.89543 22 2 21.1046 2 20V4C2 2.89543 2.89543 2 4 2Z" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <path d="M9 7H15" stroke="white" stroke-width="2" stroke-linecap="round"/>
                        <path d="M9 11H15" stroke="white" stroke-width="2" stroke-linecap="round"/>
                        <path d="M9 15H13" stroke="white" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </div>
            </div>
            <div class="app-icon" data-app="å›¾æ ‡" onclick="window.location.href='tubiao.html'">
                <div class="icon-bg">
                    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="white" stroke-width="2"/>
                        <circle cx="12" cy="12" r="3" stroke="white" stroke-width="2"/>
                        <path d="M3 12H21" stroke="white" stroke-width="2" stroke-linecap="round"/>
                        <path d="M12 3V21" stroke="white" stroke-width="2" stroke-linecap="round"/>
                    </svg>
                </div>
            </div>
        </div>

        <!-- éšè—æ–‡ä»¶è¾“å…¥æ¡† -->
        <input type="file" id="avatarUpload" class="hidden-file-input" accept="image/*">

        <!-- æ­Œæ›²ä¿¡æ¯å¼¹çª— -->
        <div class="modal" id="songModal">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title">è®¾ç½®æ­Œæ›²ä¿¡æ¯</div>
                    <button class="close-btn" onclick="closeSongModal()">&times;</button>
                </div>
                <div class="form-group">
                    <label class="form-label">ä¸Šä¼ MP3æ–‡ä»¶</label>
                    <div class="upload-area" onclick="document.getElementById('mp3Upload').click()">
                        <div class="upload-icon">ğŸµ</div>
                        <div class="upload-text">ç‚¹å‡»é€‰æ‹©MP3æ–‡ä»¶</div>
                    </div>
                    <input type="file" id="mp3Upload" class="hidden-file-input" accept="audio/mpeg" onchange="handleMp3Upload(event)">
                </div>
                <div class="form-group">
                    <label class="form-label">æ­Œæ›²åç§°</label>
                    <input type="text" class="form-input" id="songNameInput" placeholder="è¯·è¾“å…¥æ­Œæ›²åç§°">
                </div>
                <div class="form-group">
                    <label class="form-label">æ­Œæ‰‹</label>
                    <input type="text" class="form-input" id="artistNameInput" placeholder="è¯·è¾“å…¥æ­Œæ‰‹åç§°">
                </div>
                <button class="submit-btn" id="saveSongBtn" onclick="saveSongInfo()" disabled>ä¿å­˜</button>
            </div>
        </div>

        <!-- å¤©æ°”é€‰æ‹©å¼¹çª— -->
        <div class="modal" id="weatherModal">
            <div class="modal-content">
                <div class="modal-header">
                    <div class="modal-title">é€‰æ‹©åŸå¸‚</div>
                    <button class="close-btn" onclick="closeWeatherModal()">&times;</button>
                </div>
                <div class="form-group">
                    <label class="form-label">æœç´¢åŸå¸‚</label>
                    <input type="text" class="form-input" id="citySearchInput" placeholder="è¯·è¾“å…¥åŸå¸‚åç§°ï¼Œå¦‚ï¼šåŒ—äº¬ã€çº½çº¦ã€ä¼¦æ•¦" oninput="searchCities()">
                    <div id="searchResults" style="max-height: 200px; overflow-y: auto; margin-top: 10px; display: none;"></div>
                </div>
                <div class="form-group">
                    <label class="form-label">çƒ­é—¨åŸå¸‚</label>
                    <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px;">
                        <button class="submit-btn" style="flex: 1; min-width: 80px; padding: 8px;" onclick="selectCity('åŒ—äº¬')">åŒ—äº¬</button>
                        <button class="submit-btn" style="flex: 1; min-width: 80px; padding: 8px;" onclick="selectCity('ä¸Šæµ·')">ä¸Šæµ·</button>
                        <button class="submit-btn" style="flex: 1; min-width: 80px; padding: 8px;" onclick="selectCity('å¹¿å·')">å¹¿å·</button>
                        <button class="submit-btn" style="flex: 1; min-width: 80px; padding: 8px;" onclick="selectCity('æ·±åœ³')">æ·±åœ³</button>
                        <button class="submit-btn" style="flex: 1; min-width: 80px; padding: 8px;" onclick="selectCity('æ­å·')">æ­å·</button>
                        <button class="submit-btn" style="flex: 1; min-width: 80px; padding: 8px;" onclick="selectCity('æˆéƒ½')">æˆéƒ½</button>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">å›½é™…åŸå¸‚</label>
                    <div style="display: flex; flex-wrap: wrap; gap: 10px; margin-top: 10px;">
                        <button class="submit-btn" style="flex: 1; min-width: 80px; padding: 8px;" onclick="selectCity('çº½çº¦')">çº½çº¦</button>
                        <button class="submit-btn" style="flex: 1; min-width: 80px; padding: 8px;" onclick="selectCity('ä¼¦æ•¦')">ä¼¦æ•¦</button>
                        <button class="submit-btn" style="flex: 1; min-width: 80px; padding: 8px;" onclick="selectCity('ä¸œäº¬')">ä¸œäº¬</button>
                        <button class="submit-btn" style="flex: 1; min-width: 80px; padding: 8px;" onclick="selectCity('å·´é»')">å·´é»</button>
                        <button class="submit-btn" style="flex: 1; min-width: 80px; padding: 8px;" onclick="selectCity('æ‚‰å°¼')">æ‚‰å°¼</button>
                        <button class="submit-btn" style="flex: 1; min-width: 80px; padding: 8px;" onclick="selectCity('è«æ–¯ç§‘')">è«æ–¯ç§‘</button>
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">å·²é€‰æ‹©åŸå¸‚</label>
                    <input type="text" class="form-input" id="cityInput" placeholder="è¯·è¾“å…¥æˆ–é€‰æ‹©åŸå¸‚åç§°">
                </div>
                <button class="submit-btn" onclick="updateWeatherByCity()">ç¡®å®š</button>
            </div>
        </div>

        <script>
            // æ›´æ–°æ—¶é—´
            function updateTime() {
                const now = new Date();
                const timeString = now.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' });
                document.getElementById('current-time').textContent = timeString;
                
                // æ›´æ–°å°ç»„ä»¶ä¸­çš„æ—¶é—´
                updateWidgetTime();
                
                // æ›´æ–°å¤©æ°”ç»„ä»¶ä¸­çš„æ˜ŸæœŸå’Œæ—¥æœŸ
                const weekdays = ['æ˜ŸæœŸæ—¥', 'æ˜ŸæœŸä¸€', 'æ˜ŸæœŸäºŒ', 'æ˜ŸæœŸä¸‰', 'æ˜ŸæœŸå››', 'æ˜ŸæœŸäº”', 'æ˜ŸæœŸå…­'];
                const months = ['1æœˆ', '2æœˆ', '3æœˆ', '4æœˆ', '5æœˆ', '6æœˆ', '7æœˆ', '8æœˆ', '9æœˆ', '10æœˆ', '11æœˆ', '12æœˆ'];
                
                const weekday = weekdays[now.getDay()];
                const month = months[now.getMonth()];
                const date = now.getDate();
                
                document.getElementById('weatherDay').textContent = weekday;
                document.getElementById('weatherDate').textContent = `${month}${date}æ—¥`;
            }

            // æ¯ç§’æ›´æ–°ä¸€æ¬¡æ—¶é—´
            setInterval(updateTime, 1000);
            updateTime(); // åˆå§‹åŒ–æ—¶é—´

            // é¡µé¢åŠ è½½æ—¶æ£€æŸ¥æ˜¯å¦æœ‰ä¿å­˜çš„å£çº¸
            window.addEventListener('load', function() {
                updateTime();
                loadProfileData();
                loadWallpaper();
                initMusicPlayer();
                loadDisplayPhoto(); // åŠ è½½å±•ç¤ºç…§ç‰‡
                loadWeatherData(); // åŠ è½½å¤©æ°”æ•°æ®
                loadCustomIcons(); // åŠ è½½è‡ªå®šä¹‰å›¾æ ‡
                loadVoiceAvatar(); // åŠ è½½è¯­éŸ³å¤´åƒ
                
                // å»¶è¿ŸåŠ è½½æµªæ¼«å¤´åƒå’Œçºªå¿µæ—¥æ•°æ®ï¼Œç¡®ä¿DOMå®Œå…¨æ¸²æŸ“
                setTimeout(function() {
                    loadRomanticAvatars();
                    console.log('æµªæ¼«å¤´åƒåŠ è½½å®Œæˆ');
                    // æ›´æ–°å¤©æ•°æ˜¾ç¤º
                    updateDaysDisplay();
                    // åŠ è½½å°ç»„ä»¶æ•°æ®
                    loadWidgetData();
                    // ç¡®ä¿é¡µé¢åˆå§‹ä½ç½®æ­£ç¡®
                    initializePagePositions();
                }, 500); // å»¶è¿Ÿ500æ¯«ç§’ï¼Œç¡®ä¿é¡µé¢å®Œå…¨åŠ è½½
                
                // ä»æœ¬åœ°å­˜å‚¨åŠ è½½å¤©æ°”çŠ¶æ€ï¼Œå¦‚æœæ²¡æœ‰åˆ™é»˜è®¤ä¸ºæ™´å¤©
                const savedWeatherState = localStorage.getItem('weatherState') || 'sunny';
                setWeatherState(savedWeatherState);
            });
                    
            // åˆå§‹åŒ–é¡µé¢ä½ç½®
            function initializePagePositions() {
                const page1 = document.getElementById('page1');
                const page2 = document.getElementById('page2');
                const page3 = document.getElementById('page3');
                        
                // ç¡®ä¿é¡µé¢åˆå§‹ä½ç½®æ­£ç¡®
                if (page1) page1.style.transform = 'translateX(0)';
                if (page2) page2.style.transform = 'translateX(100%)';
                if (page3) page3.style.transform = 'translateX(100%)';
            }

            // ç›‘å¬æ¥è‡ªå›¾æ ‡ç®¡ç†é¡µé¢çš„æ¶ˆæ¯
            window.addEventListener('message', function(event) {
                try {
                    if (event.data.type === 'updateIcon') {
                        // ç‰¹æ®Šå¤„ç†ï¼šå¦‚æœæ›´æ–°çš„æ˜¯åç‰‡å¤´åƒï¼Œç›´æ¥æ›´æ–°å¤´åƒæ˜¾ç¤º
                        if (event.data.iconId === 'profile-avatar') {
                            const profileAvatarElement = document.getElementById('profileAvatar');
                            if (profileAvatarElement) {
                                profileAvatarElement.innerHTML = `<img src="${event.data.iconData}" alt="å¤´åƒ" style="width:100%;height:100%;object-fit:cover;object-position:center;border-radius:50%;">`;
                            }
                            // åŒæ—¶ä¿å­˜åˆ°localStorage
                            try {
                                localStorage.setItem('profileAvatar', event.data.iconData);
                            } catch (storageError) {
                                console.error('ä¿å­˜åç‰‡å¤´åƒåˆ°localStorageæ—¶å‡ºé”™:', storageError);
                                // æ£€æŸ¥æ˜¯å¦æ˜¯å­˜å‚¨ç©ºé—´ä¸è¶³é”™è¯¯
                                if (storageError.name === 'QuotaExceededError' || storageError.code === 22) {
                                    alert('å­˜å‚¨ç©ºé—´ä¸è¶³ï¼Œæ— æ³•ä¿å­˜å¤´åƒã€‚è¯·æ¸…ç†å­˜å‚¨ç©ºé—´åé‡è¯•ã€‚');
                                } else {
                                    alert('ä¿å­˜å¤´åƒæ—¶å‡ºé”™ï¼Œè¯·é‡è¯•ã€‚');
                                }
                            }
                        } else {
                            updateAppIcon(event.data.iconId, event.data.iconData);
                        }
                    } else if (event.data.type === 'restoreIcons') {
                        loadCustomIcons(); // é‡æ–°åŠ è½½æ‰€æœ‰å›¾æ ‡
                    }
                } catch (error) {
                    console.error('å¤„ç†å›¾æ ‡æ›´æ–°æ¶ˆæ¯æ—¶å‡ºé”™:', error);
                }
            });

            // åŠ è½½è‡ªå®šä¹‰å›¾æ ‡
            function loadCustomIcons() {
                // ä¸»å±å¹•åº”ç”¨å›¾æ ‡
                const mainScreenApps = [
                    { id: 'bizhi', selector: '.app-icon[data-app="å£çº¸"]' },
                    { id: 'shezhi', selector: '.app-icon[data-app="è®¾ç½®"]' },
                    { id: 'chat', selector: '.app-icon[data-app="èŠå¤©"]' },
                    { id: 'yinyue', selector: '.app-icon[data-app="éŸ³ä¹"]' },
                    { id: 'riji', selector: '.app-icon[data-app="æ—¥è®°"]' },
                    { id: 'gouwu', selector: '.app-icon[data-app="è´­ç‰©"]' },
                    { id: 'luntan', selector: '.app-icon[data-app="è®ºå›"]' },
                    { id: 'beiwanglu', selector: '.app-icon[data-app="å¤‡å¿˜å½•"]' },
                    { id: 'qianbao', selector: '.app-icon[data-app="é’±åŒ…"]' },
                    { id: 'dianhua', selector: '.app-icon[data-app="ç”µè¯"]' },
                    { id: 'peiban', selector: '.app-icon[data-app="é™ªä¼´"]' },
                    { id: 'chouka', selector: '.app-icon[data-app="æŠ½å¡"]' }
                ];
                
                mainScreenApps.forEach(app => {
                    try {
                        const customIcon = localStorage.getItem(`customIcon_${app.id}`);
                        if (customIcon) {
                            const appIcon = document.querySelector(app.selector);
                            if (appIcon) {
                                const iconBg = appIcon.querySelector('.icon-bg');
                                if (iconBg) {
                                    iconBg.innerHTML = `<img src="${customIcon}" alt="${app.id}" style="width:100%;height:100%;object-fit:cover;border-radius:18px;">`;
                                }
                            }
                        }
                    } catch (error) {
                        console.error(`åŠ è½½ä¸»å±å¹•å›¾æ ‡ ${app.id} æ—¶å‡ºé”™:`, error);
                        // æ¸…ç†æœ‰é—®é¢˜çš„å›¾æ ‡æ•°æ®
                        try {
                            localStorage.removeItem(`customIcon_${app.id}`);
                        } catch (removeError) {
                            console.error(`æ¸…ç†ä¸»å±å¹•å›¾æ ‡ ${app.id} æ—¶å‡ºé”™:`, removeError);
                        }
                    }
                });
                
                // Dockæ åº”ç”¨å›¾æ ‡
                const dockApps = [
                    { id: 'jueseshu-dock', selector: '.dock .app-icon[data-app="è§’è‰²ä¹¦"]' },
                    { id: 'shijieshu-dock', selector: '.dock .app-icon[data-app="ä¸–ç•Œä¹¦"]' },
                    { id: 'shuomingshu-dock', selector: '.dock .app-icon[data-app="è¯´æ˜ä¹¦"]' },
                    { id: 'tubiao-dock', selector: '.dock .app-icon[data-app="å›¾æ ‡"]' }
                ];
                
                dockApps.forEach(app => {
                    try {
                        const customIcon = localStorage.getItem(`customIcon_${app.id}`);
                        if (customIcon) {
                            const appIcon = document.querySelector(app.selector);
                            if (appIcon) {
                                const iconBg = appIcon.querySelector('.icon-bg');
                                if (iconBg) {
                                    iconBg.innerHTML = `<img src="${customIcon}" alt="${app.id}" style="width:100%;height:100%;object-fit:cover;border-radius:20px;">`;
                                }
                            }
                        }
                    } catch (error) {
                        console.error(`åŠ è½½Dockæ å›¾æ ‡ ${app.id} æ—¶å‡ºé”™:`, error);
                        // æ¸…ç†æœ‰é—®é¢˜çš„å›¾æ ‡æ•°æ®
                        try {
                            localStorage.removeItem(`customIcon_${app.id}`);
                        } catch (removeError) {
                            console.error(`æ¸…ç†Dockæ å›¾æ ‡ ${app.id} æ—¶å‡ºé”™:`, removeError);
                        }
                    }
                });
            }

            // æ›´æ–°å•ä¸ªåº”ç”¨å›¾æ ‡
            function updateAppIcon(iconId, iconData) {
                try {
                    // ä¸»å±å¹•åº”ç”¨å›¾æ ‡
                    const mainScreenApps = [
                        { id: 'bizhi', selector: '.app-icon[data-app="å£çº¸"]' },
                        { id: 'shezhi', selector: '.app-icon[data-app="è®¾ç½®"]' },
                        { id: 'chat', selector: '.app-icon[data-app="èŠå¤©"]' },
                        { id: 'yinyue', selector: '.app-icon[data-app="éŸ³ä¹"]' },
                        { id: 'riji', selector: '.app-icon[data-app="æ—¥è®°"]' },
                        { id: 'gouwu', selector: '.app-icon[data-app="è´­ç‰©"]' },
                        { id: 'luntan', selector: '.app-icon[data-app="è®ºå›"]' },
                        { id: 'beiwanglu', selector: '.app-icon[data-app="å¤‡å¿˜å½•"]' },
                        { id: 'qianbao', selector: '.app-icon[data-app="é’±åŒ…"]' },
                        { id: 'dianhua', selector: '.app-icon[data-app="ç”µè¯"]' },
                        { id: 'peiban', selector: '.app-icon[data-app="é™ªä¼´"]' },
                        { id: 'chouka', selector: '.app-icon[data-app="æŠ½å¡"]' }
                    ];
                    
                    // Dockæ åº”ç”¨å›¾æ ‡
                    const dockApps = [
                        { id: 'jueseshu-dock', selector: '.dock .app-icon[data-app="è§’è‰²ä¹¦"]' },
                        { id: 'shijieshu-dock', selector: '.dock .app-icon[data-app="ä¸–ç•Œä¹¦"]' },
                        { id: 'shuomingshu-dock', selector: '.dock .app-icon[data-app="è¯´æ˜ä¹¦"]' },
                        { id: 'tubiao-dock', selector: '.dock .app-icon[data-app="å›¾æ ‡"]' }
                    ];
                    
                    // æŸ¥æ‰¾åŒ¹é…çš„åº”ç”¨
                    const allApps = [...mainScreenApps, ...dockApps];
                    const app = allApps.find(a => a.id === iconId);
                    
                    if (app) {
                        const appIcon = document.querySelector(app.selector);
                        if (appIcon) {
                            const iconBg = appIcon.querySelector('.icon-bg');
                            if (iconBg) {
                                // æ ¹æ®åº”ç”¨ç±»å‹è®¾ç½®ä¸åŒçš„åœ†è§’
                                const borderRadius = iconId.includes('-dock') ? '20px' : '18px';
                                iconBg.innerHTML = `<img src="${iconData}" alt="${iconId}" style="width:100%;height:100%;object-fit:cover;border-radius:${borderRadius};">`;
                            }
                        }
                    } else {
                        console.warn('æœªæ‰¾åˆ°åŒ¹é…çš„åº”ç”¨å›¾æ ‡:', iconId);
                    }
                } catch (error) {
                    console.error('æ›´æ–°åº”ç”¨å›¾æ ‡æ—¶å‡ºé”™:', error);
                    // æ£€æŸ¥æ˜¯å¦æ˜¯å­˜å‚¨ç©ºé—´ä¸è¶³é”™è¯¯
                    if (error.name === 'QuotaExceededError' || error.code === 22) {
                        alert('å­˜å‚¨ç©ºé—´ä¸è¶³ï¼Œæ— æ³•æ›´æ–°å›¾æ ‡ã€‚è¯·æ¸…ç†å­˜å‚¨ç©ºé—´åé‡è¯•ã€‚');
                    } else {
                        alert('æ›´æ–°å›¾æ ‡æ—¶å‡ºé”™ï¼Œè¯·é‡è¯•ã€‚');
                    }
                }
            }

            // åŠ è½½ä¸ªäººèµ„æ–™æ•°æ®
            function loadProfileData() {
                try {
                    // åŠ è½½å¤´åƒ
                    const savedAvatar = localStorage.getItem('profileAvatar');
                    if (savedAvatar) {
                        document.getElementById('profileAvatar').innerHTML = `<img src="${savedAvatar}" alt="å¤´åƒ" style="width:100%;height:100%;object-fit:cover;object-position:center;border-radius:50%;">`;
                    }

                    // åŠ è½½æ˜µç§°
                    const savedNickname = localStorage.getItem('profileNickname');
                    if (savedNickname) {
                        document.getElementById('profileNickname').textContent = savedNickname;
                    }

                    // åŠ è½½ä¸ªæ€§ç­¾å
                    const savedSignature = localStorage.getItem('profileSignature');
                    if (savedSignature) {
                        document.getElementById('profileSignature').textContent = savedSignature;
                    }
                } catch (error) {
                    console.error('åŠ è½½ä¸ªäººèµ„æ–™æ—¶å‡ºé”™:', error);
                }
            }

            // åŠ è½½å£çº¸
            function loadWallpaper() {
                const savedWallpaper = localStorage.getItem('wallpaper');
                const wallpaperElement = document.getElementById('wallpaper');
                
                // æ¸…é™¤ç°æœ‰çš„å£çº¸
                wallpaperElement.style.backgroundImage = '';
                wallpaperElement.innerHTML = '';
                
                if (savedWallpaper) {
                    try {
                        // è§£æå£çº¸æ•°æ®
                        const wallpaperData = JSON.parse(savedWallpaper);
                        
                        if (wallpaperData && wallpaperData.src) {
                            if (wallpaperData.type === 'video' && wallpaperData.poster) {
                                // è§†é¢‘å£çº¸ - åˆ›å»ºè§†é¢‘å…ƒç´ 
                                wallpaperElement.innerHTML = `
                                    <video 
                                        src="${wallpaperData.src}" 
                                        poster="${wallpaperData.poster}" 
                                        autoplay 
                                        muted 
                                        playsinline
                                        loop 
                                        style="width:100%;height:100%;object-fit:cover;position:absolute;top:0;left:0;z-index:-1;">
                                    </video>
                                `;
                                
                                // ç¡®ä¿è§†é¢‘åœ¨é¡µé¢åŠ è½½åæ’­æ”¾
                                setTimeout(() => {
                                    const video = wallpaperElement.querySelector('video');
                                    if (video) {
                                        // ç¡®ä¿è§†é¢‘æ˜¯é™éŸ³çš„
                                        video.muted = true;
                                        video.playsInline = true;
                                        
                                        // æ£€æŸ¥æ˜¯å¦æ”¯æŒè‡ªåŠ¨æ’­æ”¾
                                        video.play().catch(e => {
                                            console.error('è‡ªåŠ¨æ’­æ”¾å¤±è´¥:', e);
                                        });
                                    }
                                }, 100);
                            } else if (wallpaperData.type === 'image') {
                                // å›¾ç‰‡å£çº¸ - è®¾ç½®èƒŒæ™¯å›¾ç‰‡
                                wallpaperElement.style.backgroundImage = `url(${wallpaperData.src})`;
                            }
                        }
                    } catch (e) {
                        console.error('è§£æå£çº¸æ•°æ®æ—¶å‡ºé”™:', e);
                    }
                }
            }

            // ä¿å­˜å£çº¸
            function saveWallpaper(wallpaperData) {
                localStorage.setItem('wallpaper', JSON.stringify(wallpaperData));
                loadWallpaper();
            }

            // ä¿å­˜ä¸ªäººèµ„æ–™æ•°æ®
            function saveProfileData(avatar, nickname, signature) {
                if (avatar) {
                    localStorage.setItem('profileAvatar', avatar);
                }
                if (nickname) {
                    localStorage.setItem('profileNickname', nickname);
                }
                if (signature) {
                    localStorage.setItem('profileSignature', signature);
                }
                loadProfileData();
            }

            // æ”¶è—æ­Œæ›²
            function toggleFavorite(songName) {
                const isFavorite = localStorage.getItem(`favorite_${songName}`) === 'true';
                localStorage.setItem(`favorite_${songName}`, !isFavorite);
                initMusicPlayer();
            }

            // è®¾ç½®äº‹ä»¶ç›‘å¬å™¨
            // æ›´æ¢ä¸ªæ€§ç­¾å
            function changeSignature() {
                const signature = prompt('è¯·è¾“å…¥æ‚¨çš„ä¸ªæ€§ç­¾åï¼š', document.getElementById('profileSignature').textContent);
                if (signature !== null) {
                    document.getElementById('profileSignature').textContent = signature;
                    localStorage.setItem('profileSignature', signature);
                }
            }

            // æ›´æ¢ç…§ç‰‡
            function changePhoto(photoNumber) {
                // åˆ›å»ºæ–‡ä»¶è¾“å…¥å…ƒç´ 
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'image/*';
                input.onchange = function(event) {
                    const file = event.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            // æ›´æ–°ç…§ç‰‡æ˜¾ç¤ºï¼Œç¡®ä¿æ­£ç¡®æ¯”ä¾‹
                            const photoCard = document.querySelector(`.photo-card-${photoNumber}`);
                            photoCard.innerHTML = `<img src="${e.target.result}" alt="ç…§ç‰‡${photoNumber}" style="width:100%;height:100%;object-fit:cover;object-position:center;">`;
                            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                            localStorage.setItem(`photo${photoNumber}`, e.target.result);
                        };
                        reader.readAsDataURL(file);
                    }
                };
                input.click();
            }

            // åŠ è½½ä¿å­˜çš„ç…§ç‰‡
            function loadSavedPhotos() {
                for (let i = 1; i <= 3; i++) {
                    const savedPhoto = localStorage.getItem(`photo${i}`);
                    if (savedPhoto) {
                        const photoCard = document.querySelector(`.photo-card-${i}`);
                        photoCard.innerHTML = `<img src="${savedPhoto}" alt="ç…§ç‰‡${i}" style="width:100%;height:100%;object-fit:cover;object-position:center;">`;
                    }
                }
            }

            // ç‚¹å‡»æ­Œæ›²åæ‰“å¼€å¼¹çª—
            function openSongModal() {
                document.getElementById('songModal').classList.add('active');
                // åŠ è½½å·²ä¿å­˜çš„æ­Œæ›²ä¿¡æ¯
                const savedSong = localStorage.getItem('currentSong');
                if (savedSong) {
                    const song = JSON.parse(savedSong);
                    document.getElementById('songNameInput').value = song.name;
                    document.getElementById('artistNameInput').value = song.artist;
                    document.getElementById('saveSongBtn').disabled = false;
                }
                
                // æ£€æŸ¥æ˜¯å¦æœ‰ä¿å­˜çš„æ­Œæ›²æ–‡ä»¶
                const savedSongFile = localStorage.getItem('currentSongFile');
                if (savedSongFile) {
                    const songFile = JSON.parse(savedSongFile);
                    // å¦‚æœæœ‰ä¿å­˜çš„æ–‡ä»¶ï¼Œå¯ç”¨ä¿å­˜æŒ‰é’®
                    document.getElementById('saveSongBtn').disabled = false;
                }
            }

            // å…³é—­å¼¹çª—
            function closeSongModal() {
                document.getElementById('songModal').classList.remove('active');
            }

            // å¤„ç†MP3ä¸Šä¼ 
            function handleMp3Upload(event) {
                const file = event.target.files[0];
                if (file) {
                    // ä¸é™åˆ¶æ–‡ä»¶å¤§å°
                    // if (file.size > 10 * 1024 * 1024) {
                    //     alert('æ–‡ä»¶å¤ªå¤§ï¼Œè¯·é€‰æ‹©å°äº10MBçš„æ–‡ä»¶');
                    //     return;
                    // }
                    
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        // ä¿å­˜MP3æ–‡ä»¶æ•°æ®åˆ°æœ¬åœ°å­˜å‚¨
                        localStorage.setItem('currentSongFile', JSON.stringify({
                            name: file.name,
                            size: file.size,
                            type: file.type,
                            data: e.target.result,
                            lastModified: file.lastModified
                        }));
                        
                        // å¯ç”¨ä¿å­˜æŒ‰é’®
                        document.getElementById('saveSongBtn').disabled = false;
                    };
                    reader.onerror = function(e) {
                        console.error('æ–‡ä»¶è¯»å–é”™è¯¯:', e);
                        alert('æ–‡ä»¶è¯»å–å¤±è´¥ï¼Œè¯·é‡è¯•');
                    };
                    reader.readAsDataURL(file);
                }
            }

            // ä¿å­˜æ­Œæ›²ä¿¡æ¯
            function saveSongInfo() {
                const songName = document.getElementById('songNameInput').value || 'æœªçŸ¥æ­Œæ›²';
                const artistName = document.getElementById('artistNameInput').value || 'æœªçŸ¥è‰ºæœ¯å®¶';
                
                // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                const songData = {
                    name: songName,
                    artist: artistName
                };
                localStorage.setItem('currentSong', JSON.stringify(songData));
                
                // æ›´æ–°é¡µé¢æ˜¾ç¤º
                document.getElementById('songName').textContent = songName;
                document.getElementById('artistName').textContent = artistName;
                
                // å…³é—­å¼¹çª—
                closeSongModal();
                
                // æ˜¾ç¤ºä¿å­˜æˆåŠŸæç¤º
                // è¿™é‡Œå¯ä»¥æ·»åŠ ä¸€ä¸ªç®€å•çš„æç¤ºï¼Œæ¯”å¦‚ä¸´æ—¶æ”¹å˜æŒ‰é’®æ–‡å­—
                const saveBtn = document.getElementById('saveSongBtn');
                const originalText = saveBtn.textContent;
                saveBtn.textContent = 'å·²ä¿å­˜';
                setTimeout(() => {
                    saveBtn.textContent = originalText;
                    saveBtn.disabled = false;
                }, 1000);
            }

            // æ›´æ¢ä¸“è¾‘å°é¢
            function changeAlbumCover() {
                // åˆ›å»ºæ–‡ä»¶è¾“å…¥å…ƒç´ 
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'image/*';
                input.onchange = function(event) {
                    const file = event.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            // æ›´æ–°å°é¢æ˜¾ç¤ºï¼Œç¡®ä¿æ­£ç¡®æ¯”ä¾‹
                            document.getElementById('albumCover').innerHTML = `<img src="${e.target.result}" alt="ä¸“è¾‘å°é¢" style="width:100%;height:100%;object-fit:cover;object-position:center;">`;
                            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                            localStorage.setItem('albumCover', e.target.result);
                        };
                        reader.readAsDataURL(file);
                    }
                };
                input.click();
            }

            // åˆ‡æ¢æ’­æ”¾/æš‚åœ
            function togglePlay() {
                const albumCover = document.getElementById('albumCover');
                const playIcon = document.getElementById('playIcon');
                const pauseIcon = document.getElementById('pauseIcon');
                const audioPlayer = document.getElementById('audioPlayer');
                
                if (albumCover.classList.contains('playing')) {
                    // æš‚åœ
                    albumCover.classList.remove('playing');
                    playIcon.style.display = 'block';
                    pauseIcon.style.display = 'none';
                    audioPlayer.pause();
                } else {
                    // æ’­æ”¾
                    albumCover.classList.add('playing');
                    playIcon.style.display = 'none';
                    pauseIcon.style.display = 'block';
                    
                    // æ£€æŸ¥æ˜¯å¦æœ‰ä¿å­˜çš„æ­Œæ›²æ–‡ä»¶
                    const savedSongFile = localStorage.getItem('currentSongFile');
                    if (savedSongFile) {
                        const songFile = JSON.parse(savedSongFile);
                        audioPlayer.src = songFile.data;
                        audioPlayer.play().catch(e => {
                            console.error('æ’­æ”¾å¤±è´¥:', e);
                            // å¦‚æœæ’­æ”¾å¤±è´¥ï¼Œå›æ»šUIçŠ¶æ€
                            albumCover.classList.remove('playing');
                            playIcon.style.display = 'block';
                            pauseIcon.style.display = 'none';
                            alert('æ’­æ”¾å¤±è´¥ï¼Œè¯·é‡è¯•');
                        });
                    } else {
                        // æ²¡æœ‰ä¸Šä¼ æ–‡ä»¶æ—¶çš„æç¤º
                        albumCover.classList.remove('playing');
                        playIcon.style.display = 'block';
                        pauseIcon.style.display = 'none';
                        alert('è¯·å…ˆä¸Šä¼ MP3æ–‡ä»¶');
                    }
                }
            }

            // ä¸Šä¸€é¦–
            function previousSong() {
                // è¿™é‡Œå¯ä»¥æ·»åŠ åˆ‡æ¢æ­Œæ›²çš„é€»è¾‘
            }

            // åˆå§‹åŒ–éŸ³ä¹æ’­æ”¾å™¨
            function initMusicPlayer() {
                // ä»æœ¬åœ°å­˜å‚¨åŠ è½½éŸ³ä¹æ•°æ®
                const savedSong = localStorage.getItem('currentSong');
                if (savedSong) {
                    try {
                        const song = JSON.parse(savedSong);
                        document.getElementById('songName').textContent = song.name;
                        document.getElementById('artistName').textContent = song.artist;
                        
                        // æ£€æŸ¥æ˜¯å¦æ”¶è—
                        const isFavorite = localStorage.getItem(`favorite_${song.name}`) === 'true';
                        if (isFavorite) {
                            document.getElementById('favoriteBtn').classList.add('active');
                        }
                    } catch (e) {
                        console.error('è§£ææ­Œæ›²æ•°æ®æ—¶å‡ºé”™:', e);
                    }
                }
                
                // åŠ è½½ä¸“è¾‘å°é¢
                const savedCover = localStorage.getItem('albumCover');
                if (savedCover) {
                    document.getElementById('albumCover').innerHTML = `<img src="${savedCover}" alt="ä¸“è¾‘å°é¢" style="width:100%;height:100%;object-fit:cover;object-position:center;">`;
                }
                
                // æ£€æŸ¥æ˜¯å¦æœ‰ä¿å­˜çš„æ­Œæ›²æ–‡ä»¶
                const savedSongFile = localStorage.getItem('currentSongFile');
                if (savedSongFile) {
                    try {
                        const songFile = JSON.parse(savedSongFile);
                        // è¿™é‡Œå¯ä»¥æ·»åŠ æ’­æ”¾æ­Œæ›²çš„é€»è¾‘
                        
                        // å¯ç”¨ä¿å­˜æŒ‰é’®
                        const saveSongBtn = document.getElementById('saveSongBtn');
                        if (saveSongBtn) {
                            saveSongBtn.disabled = false;
                        }
                    } catch (e) {
                        console.error('è§£ææ­Œæ›²æ–‡ä»¶æ•°æ®æ—¶å‡ºé”™:', e);
                    }
                }
                
                // æ·»åŠ éŸ³é¢‘æ’­æ”¾ç»“æŸäº‹ä»¶ç›‘å¬å™¨å®ç°å¾ªç¯æ’­æ”¾
                const audioPlayer = document.getElementById('audioPlayer');
                if (audioPlayer) {
                    audioPlayer.addEventListener('ended', function() {
                        // å½“éŸ³é¢‘æ’­æ”¾ç»“æŸæ—¶ï¼Œè‡ªåŠ¨é‡æ–°æ’­æ”¾
                        const albumCover = document.getElementById('albumCover');
                        const playIcon = document.getElementById('playIcon');
                        const pauseIcon = document.getElementById('pauseIcon');
                        
                        // ä¿æŒæ’­æ”¾çŠ¶æ€ä½†é‡ç½®éŸ³é¢‘
                        if (albumCover) albumCover.classList.add('playing');
                        if (playIcon) playIcon.style.display = 'none';
                        if (pauseIcon) pauseIcon.style.display = 'block';
                        
                        // é‡æ–°è®¾ç½®éŸ³é¢‘æºå¹¶æ’­æ”¾
                        const savedSongFile = localStorage.getItem('currentSongFile');
                        if (savedSongFile) {
                            try {
                                const songFile = JSON.parse(savedSongFile);
                                audioPlayer.src = songFile.data;
                                audioPlayer.currentTime = 0;
                                audioPlayer.play().catch(e => {
                                    console.error('å¾ªç¯æ’­æ”¾å¤±è´¥:', e);
                                });
                            } catch (e) {
                                console.error('è§£æå¾ªç¯æ’­æ”¾æ•°æ®æ—¶å‡ºé”™:', e);
                            }
                        }
                    });
                }
            }

            // ä¿å­˜éŸ³ä¹æ•°æ®
            function saveMusicData(song, cover, songFile) {
                if (song) {
                    localStorage.setItem('currentSong', JSON.stringify(song));
                }
                if (cover) {
                    localStorage.setItem('albumCover', cover);
                }
                if (songFile) {
                    localStorage.setItem('currentSongFile', JSON.stringify(songFile));
                }
                initMusicPlayer();
            }

            // æ›´æ¢ä¸“è¾‘å°é¢
            function changeAlbumCover() {
                // åˆ›å»ºæ–‡ä»¶è¾“å…¥å…ƒç´ 
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'image/*';
                input.onchange = function(event) {
                    const file = event.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            // æ›´æ–°å°é¢æ˜¾ç¤ºï¼Œç¡®ä¿æ­£ç¡®æ¯”ä¾‹
                            document.getElementById('albumCover').innerHTML = `<img src="${e.target.result}" alt="ä¸“è¾‘å°é¢" style="width:100%;height:100%;object-fit:cover;object-position:center;">`;
                            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                            localStorage.setItem('albumCover', e.target.result);
                        };
                        reader.readAsDataURL(file);
                    }
                };
                input.click();
            }

            // æ›´æ¢å¤´åƒ
            function changeAvatar() {
                // åˆ›å»ºæ–‡ä»¶è¾“å…¥å…ƒç´ 
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'image/*';
                input.onchange = function(event) {
                    const file = event.target.files[0];
                    if (file) {
                        // æ£€æŸ¥æ–‡ä»¶å¤§å°ï¼ˆæ— é™åˆ¶ï¼‰
                        // if (file.size > 5 * 1024 * 1024) {
                        //     alert('å›¾ç‰‡æ–‡ä»¶å¤ªå¤§ï¼Œè¯·é€‰æ‹©å°äº5MBçš„å›¾ç‰‡');
                        //     return;
                        // }
                        
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            try {
                                // æ›´æ–°å¤´åƒæ˜¾ç¤ºï¼Œç¡®ä¿æ­£ç¡®æ¯”ä¾‹
                                document.getElementById('profileAvatar').innerHTML = `<img src="${e.target.result}" alt="å¤´åƒ" style="width:100%;height:100%;object-fit:cover;object-position:center;border-radius:50%;">`;
                                // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                                localStorage.setItem('profileAvatar', e.target.result);
                            } catch (error) {
                                console.error('ä¿å­˜å¤´åƒæ—¶å‡ºé”™:', error);
                                // æ£€æŸ¥æ˜¯å¦æ˜¯å­˜å‚¨ç©ºé—´ä¸è¶³é”™è¯¯
                                if (error.name === 'QuotaExceededError' || error.code === 22) {
                                    alert('å­˜å‚¨ç©ºé—´ä¸è¶³ï¼Œæ— æ³•ä¿å­˜å¤´åƒã€‚è¯·æ¸…ç†å­˜å‚¨ç©ºé—´åé‡è¯•ã€‚');
                                } else {
                                    alert('ä¿å­˜å¤´åƒå¤±è´¥ï¼Œè¯·é‡è¯•');
                                }
                            }
                        };
                        reader.onerror = function() {
                            alert('è¯»å–å›¾ç‰‡æ–‡ä»¶æ—¶å‡ºé”™ï¼Œè¯·é‡è¯•');
                        };
                        reader.readAsDataURL(file);
                    }
                };
                input.click();
            }

            // æ›´æ¢æ˜µç§°
            function changeNickname() {
                // åˆ›å»ºè‡ªå®šä¹‰å¼¹çª—
                showCustomPrompt('è¯·è¾“å…¥æ‚¨çš„æ˜µç§°ï¼š', document.getElementById('profileNickname').textContent)
                    .then(nickname => {
                        if (nickname !== null) {
                            document.getElementById('profileNickname').textContent = nickname;
                            localStorage.setItem('profileNickname', nickname);
                        }
                    });
            }

            // æ›´æ¢ä¸ªæ€§ç­¾å
            function changeSignature() {
                // åˆ›å»ºè‡ªå®šä¹‰å¼¹çª—
                showCustomPrompt('è¯·è¾“å…¥æ‚¨çš„ä¸ªæ€§ç­¾åï¼š', document.getElementById('profileSignature').textContent)
                    .then(signature => {
                        if (signature !== null) {
                            document.getElementById('profileSignature').textContent = signature;
                            localStorage.setItem('profileSignature', signature);
                        }
                    });
            }

            // æ˜¾ç¤ºè‡ªå®šä¹‰æç¤ºå¼¹çª—ï¼ˆæ›¿ä»£æµè§ˆå™¨promptï¼‰
            function showCustomPrompt(message, defaultValue) {
                return new Promise((resolve) => {
                    // åˆ›å»ºå¼¹çª—å…ƒç´ 
                    const modal = document.createElement('div');
                    modal.className = 'modal custom-prompt-modal active';
                    modal.style.zIndex = '2000';
                    
                    modal.innerHTML = `
                        <div class="modal-content" style="max-width: 300px;">
                            <div class="modal-header">
                                <div class="modal-title">æç¤º</div>
                                <button class="close-btn" onclick="this.closest('.modal').remove()">&times;</button>
                            </div>
                            <div class="form-group">
                                <label class="form-label">${message}</label>
                                <input type="text" class="form-input" id="customPromptInput" value="${defaultValue || ''}">
                            </div>
                            <div style="display: flex; gap: 10px;">
                                <button class="submit-btn" style="flex: 1;" id="confirmBtn">ç¡®å®š</button>
                                <button class="submit-btn" style="flex: 1; background: #666;" id="cancelBtn">å–æ¶ˆ</button>
                            </div>
                        </div>
                    `;
                    
                    // æ·»åŠ åˆ°é¡µé¢
                    document.body.appendChild(modal);
                    
                    // è®¾ç½®æŒ‰é’®äº‹ä»¶å¤„ç†ç¨‹åº
                    document.getElementById('confirmBtn').onclick = function() {
                        const value = document.getElementById('customPromptInput').value;
                        document.querySelector('.custom-prompt-modal').remove();
                        resolve(value);
                    };
                    
                    document.getElementById('cancelBtn').onclick = function() {
                        document.querySelector('.custom-prompt-modal').remove();
                        resolve(null);
                    };
                    
                    // èšç„¦åˆ°è¾“å…¥æ¡†
                    setTimeout(() => {
                        document.getElementById('customPromptInput').focus();
                    }, 100);
                });
            }

            // æ˜¾ç¤ºé¡µé¢å†…æç¤ºä¿¡æ¯ï¼ˆæ›¿ä»£æµè§ˆå™¨alertï¼‰
            function showPageAlert(message) {
                // åˆ›å»ºæç¤ºå…ƒç´ 
                const alertElement = document.createElement('div');
                alertElement.style.cssText = `
                    position: fixed;
                    top: 50%;
                    left: 50%;
                    transform: translate(-50%, -50%);
                    background: rgba(0, 0, 0, 0.8);
                    color: white;
                    padding: 20px;
                    border-radius: 10px;
                    z-index: 2000;
                    text-align: center;
                    backdrop-filter: blur(10px);
                    border: 1px solid rgba(255, 255, 255, 0.1);
                    max-width: 80%;
                `;
                alertElement.textContent = message;
                
                // æ·»åŠ åˆ°é¡µé¢
                document.body.appendChild(alertElement);
                
                // 3ç§’åè‡ªåŠ¨ç§»é™¤
                setTimeout(() => {
                    if (alertElement.parentNode) {
                        alertElement.parentNode.removeChild(alertElement);
                    }
                }, 3000);
            }

            // æ›´æ¢ç…§ç‰‡å±•ç¤º
            function changePhotoDisplay() {
                // åˆ›å»ºæ–‡ä»¶è¾“å…¥å…ƒç´ 
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'image/*';
                input.onchange = function(event) {
                    const file = event.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            // æ›´æ–°ç…§ç‰‡æ˜¾ç¤º
                            document.getElementById('photoDisplay').innerHTML = `<img src="${e.target.result}" alt="å±•ç¤ºç…§ç‰‡" style="width:100%;height:100%;object-fit:cover;object-position:center;border-radius:10px;">`;
                            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                            localStorage.setItem('displayPhoto', e.target.result);
                        };
                        reader.readAsDataURL(file);
                    }
                };
                input.click();
            }

            // åŠ è½½ä¿å­˜çš„ç…§ç‰‡
            function loadDisplayPhoto() {
                const savedPhoto = localStorage.getItem('displayPhoto');
                if (savedPhoto) {
                    document.getElementById('photoDisplay').innerHTML = `<img src="${savedPhoto}" alt="å±•ç¤ºç…§ç‰‡" style="width:100%;height:100%;object-fit:cover;object-position:center;border-radius:10px;">`;
                }
            }

            // æ›´æ¢å¤´åƒ
            function changeProfileAvatar() {
                // åˆ›å»ºæ–‡ä»¶è¾“å…¥å…ƒç´ 
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'image/*';
                input.onchange = function(event) {
                    const file = event.target.files[0];
                    if (file) {
                        // åˆ›å»ºFormDataå¯¹è±¡ç”¨äºä¸Šä¼ åˆ°postimages.org
                        const formData = new FormData();
                        formData.append('upload', file);
                        
                        // æ˜¾ç¤ºä¸Šä¼ ä¸­æç¤º
                        showPageAlert('æ­£åœ¨ä¸Šä¼ å¤´åƒ...');
                        
                        // ä¸Šä¼ å›¾ç‰‡åˆ°postimages.org
                        fetch('https://postimages.org/json/1', {
                            method: 'POST',
                            body: formData
                        })
                        .then(response => response.json())
                        .then(data => {
                            if (data.url) {
                                // ä¸Šä¼ æˆåŠŸï¼Œä¿å­˜å›¾ç‰‡URLè€Œä¸æ˜¯base64æ•°æ®
                                try {
                                    // æ›´æ–°å¤´åƒæ˜¾ç¤ºï¼Œç¡®ä¿æ­£ç¡®æ¯”ä¾‹
                                    document.getElementById('profileAvatar').innerHTML = `<img src="${data.url}" alt="å¤´åƒ" style="width:100%;height:100%;object-fit:cover;object-position:center;border-radius:50%;">`;
                                    // ä¿å­˜URLåˆ°æœ¬åœ°å­˜å‚¨
                                    localStorage.setItem('profileAvatar', data.url);
                                    showPageAlert('å¤´åƒå·²æ›´æ–°');
                                } catch (error) {
                                    console.error('ä¿å­˜å¤´åƒURLæ—¶å‡ºé”™:', error);
                                    alert('ä¿å­˜å¤´åƒå¤±è´¥ï¼Œè¯·é‡è¯•');
                                }
                            } else {
                                throw new Error('ä¸Šä¼ å¤±è´¥');
                            }
                        })
                        .catch(error => {
                            console.error('ä¸Šä¼ å¤´åƒåˆ°postimages.orgæ—¶å‡ºé”™:', error);
                            alert('ä¸Šä¼ å¤´åƒå¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥åé‡è¯•');
                        });
                    }
                };
                input.click();
            }
            function uploadRomanticAvatarLeft() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'image/*';
                input.onchange = function(event) {
                    const file = event.target.files[0];
                    if (file) {
                        // åˆ›å»ºFormDataå¯¹è±¡ç”¨äºä¸Šä¼ åˆ°postimages.org
                        const formData = new FormData();
                        formData.append('upload', file);
                        
                        // æ˜¾ç¤ºä¸Šä¼ ä¸­æç¤º
                        showPageAlert('æ­£åœ¨ä¸Šä¼ å·¦ä¾§å¤´åƒ...');
                        
                        // ä¸Šä¼ å›¾ç‰‡åˆ°postimages.org
                        fetch('https://postimages.org/json/1', {
                            method: 'POST',
                            body: formData
                        })
                        .then(response => response.json())
                        .then(data => {
                            if (data.url) {
                                // ä¸Šä¼ æˆåŠŸï¼Œä¿å­˜å›¾ç‰‡URLè€Œä¸æ˜¯base64æ•°æ®
                                try {
                                    // æ›´æ–°å¤´åƒæ˜¾ç¤ºï¼Œç¡®ä¿æ­£ç¡®æ¯”ä¾‹
                                    const container = document.getElementById('romanticAvatarLeftContainer');
                                    if (container) {
                                        container.innerHTML = `<img src="${data.url}" alt="å·¦ä¾§å¤´åƒ" style="width:100%;height:100%;object-fit:cover;object-position:center;border-radius:50%;">`;
                                        // ä¿å­˜URLåˆ°æœ¬åœ°å­˜å‚¨
                                        localStorage.setItem('romanticAvatarLeft', data.url);
                                        console.log('å·¦ä¾§å¤´åƒå·²ä¿å­˜');
                                        showPageAlert('å·¦ä¾§å¤´åƒå·²æ›´æ–°');
                                    }
                                } catch (error) {
                                    console.error('ä¿å­˜å¤´åƒURLæ—¶å‡ºé”™:', error);
                                    alert('ä¿å­˜å¤´åƒå¤±è´¥ï¼Œè¯·é‡è¯•');
                                }
                            } else {
                                throw new Error('ä¸Šä¼ å¤±è´¥');
                            }
                        })
                        .catch(error => {
                            console.error('ä¸Šä¼ å¤´åƒåˆ°postimages.orgæ—¶å‡ºé”™:', error);
                            alert('ä¸Šä¼ å¤´åƒå¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥åé‡è¯•');
                        });
                    }
                };
                input.click();
            }
            function uploadRomanticAvatarRight() {
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'image/*';
                input.onchange = function(event) {
                    const file = event.target.files[0];
                    if (file) {
                        // åˆ›å»ºFormDataå¯¹è±¡ç”¨äºä¸Šä¼ åˆ°postimages.org
                        const formData = new FormData();
                        formData.append('upload', file);
                        
                        // æ˜¾ç¤ºä¸Šä¼ ä¸­æç¤º
                        showPageAlert('æ­£åœ¨ä¸Šä¼ å³ä¾§å¤´åƒ...');
                        
                        // ä¸Šä¼ å›¾ç‰‡åˆ°postimages.org
                        fetch('https://postimages.org/json/1', {
                            method: 'POST',
                            body: formData
                        })
                        .then(response => response.json())
                        .then(data => {
                            if (data.url) {
                                // ä¸Šä¼ æˆåŠŸï¼Œä¿å­˜å›¾ç‰‡URLè€Œä¸æ˜¯base64æ•°æ®
                                try {
                                    // æ›´æ–°å¤´åƒæ˜¾ç¤ºï¼Œç¡®ä¿æ­£ç¡®æ¯”ä¾‹
                                    const container = document.getElementById('romanticAvatarRightContainer');
                                    if (container) {
                                        container.innerHTML = `<img src="${data.url}" alt="å³ä¾§å¤´åƒ" style="width:100%;height:100%;object-fit:cover;object-position:center;border-radius:50%;">`;
                                        // ä¿å­˜URLåˆ°æœ¬åœ°å­˜å‚¨
                                        localStorage.setItem('romanticAvatarRight', data.url);
                                        console.log('å³ä¾§å¤´åƒå·²ä¿å­˜');
                                        showPageAlert('å³ä¾§å¤´åƒå·²æ›´æ–°');
                                    }
                                } catch (error) {
                                    console.error('ä¿å­˜å¤´åƒURLæ—¶å‡ºé”™:', error);
                                    alert('ä¿å­˜å¤´åƒå¤±è´¥ï¼Œè¯·é‡è¯•');
                                }
                            } else {
                                throw new Error('ä¸Šä¼ å¤±è´¥');
                            }
                        })
                        .catch(error => {
                            console.error('ä¸Šä¼ å¤´åƒåˆ°postimages.orgæ—¶å‡ºé”™:', error);
                            alert('ä¸Šä¼ å¤´åƒå¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥åé‡è¯•');
                        });
                    }
                };
                input.click();
            }
            // æ·»åŠ æ›´æ¢è¯­éŸ³å¤´åƒçš„å‡½æ•°
            function changeVoiceAvatar() {
                // åˆ›å»ºæ–‡ä»¶è¾“å…¥å…ƒç´ 
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'image/*';
                input.onchange = function(event) {
                    const file = event.target.files[0];
                    if (file) {
                        // åˆ›å»ºFormDataå¯¹è±¡ç”¨äºä¸Šä¼ åˆ°postimages.org
                        const formData = new FormData();
                        formData.append('upload', file);
                        
                        // æ˜¾ç¤ºä¸Šä¼ ä¸­æç¤º
                        showPageAlert('æ­£åœ¨ä¸Šä¼ è¯­éŸ³å¤´åƒ...');
                        
                        // ä¸Šä¼ å›¾ç‰‡åˆ°postimages.org
                        fetch('https://postimages.org/json/1', {
                            method: 'POST',
                            body: formData
                        })
                        .then(response => response.json())
                        .then(data => {
                            if (data.url) {
                                // ä¸Šä¼ æˆåŠŸï¼Œä¿å­˜å›¾ç‰‡URLè€Œä¸æ˜¯base64æ•°æ®
                                try {
                                    // æ›´æ–°è¯­éŸ³å¤´åƒæ˜¾ç¤º
                                    const avatarImg = document.getElementById('voiceAvatarImg');
                                    const avatarPlaceholder = document.getElementById('voiceAvatarPlaceholder');
                                    avatarImg.src = data.url;
                                    avatarImg.style.display = 'block';
                                    avatarPlaceholder.style.display = 'none';
                                    // ä¿å­˜URLåˆ°æœ¬åœ°å­˜å‚¨
                                    localStorage.setItem('voiceAvatar', data.url);
                                    showPageAlert('è¯­éŸ³å¤´åƒå·²æ›´æ–°');
                                } catch (error) {
                                    console.error('ä¿å­˜è¯­éŸ³å¤´åƒURLæ—¶å‡ºé”™:', error);
                                    alert('ä¿å­˜è¯­éŸ³å¤´åƒå¤±è´¥ï¼Œè¯·é‡è¯•');
                                }
                            } else {
                                throw new Error('ä¸Šä¼ å¤±è´¥');
                            }
                        })
                        .catch(error => {
                            console.error('ä¸Šä¼ è¯­éŸ³å¤´åƒåˆ°postimages.orgæ—¶å‡ºé”™:', error);
                            alert('ä¸Šä¼ è¯­éŸ³å¤´åƒå¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥åé‡è¯•');
                        });
                    }
                };
                input.click();
            }
            function showPageAlert(message) {
                const alertContainer = document.getElementById('pageAlertContainer');
                const alertMessage = document.getElementById('pageAlertMessage');
                alertMessage.textContent = message;
                alertContainer.style.display = 'block';
                setTimeout(() => {
                    alertContainer.style.display = 'none';
                }, 3000);
            }
            function loadSettings() {
                const settings = JSON.parse(localStorage.getItem('settings')) || {};
                document.getElementById('voiceName').value = settings.voiceName || 'default';
                document.getElementById('voiceSpeed').value = settings.voiceSpeed || 1;
                document.getElementById('voicePitch').value = settings.voicePitch || 1;
                document.getElementById('voiceVolume').value = settings.voiceVolume || 1;
                document.getElementById('voiceAvatarImg').src = localStorage.getItem('voiceAvatar') || '';
                document.getElementById('voiceAvatarPlaceholder').style.display = localStorage.getItem('voiceAvatar') ? 'none' : 'block';
                document.getElementById('romanticAvatarLeftContainer').innerHTML = localStorage.getItem('romanticAvatarLeft') ? `<img src="${localStorage.getItem('romanticAvatarLeft')}" alt="å·¦ä¾§å¤´åƒ" style="width:100%;height:100%;object-fit:cover;object-position:center;border-radius:50%;">` : '';
                document.getElementById('romanticAvatarRightContainer').innerHTML = localStorage.getItem('romanticAvatarRight') ? `<img src="${localStorage.getItem('romanticAvatarRight')}" alt="å³ä¾§å¤´åƒ" style="width:100%;height:100%;object-fit:cover;object-position:center;border-radius:50%;">` : '';
            }
            function saveSettings() {
                const settings = {
                    voiceName: document.getElementById('voiceName').value,
                    voiceSpeed: parseFloat(document.getElementById('voiceSpeed').value),
                    voicePitch: parseFloat(document.getElementById('voicePitch').value),
                    voiceVolume: parseFloat(document.getElementById('voiceVolume').value)
                };
                localStorage.setItem('settings', JSON.stringify(settings));
                showPageAlert('è®¾ç½®å·²ä¿å­˜');
            }

            // åŠ è½½ä¿å­˜çš„å¤´åƒ
            function loadProfileAvatar() {
                const savedAvatar = localStorage.getItem('profileAvatar');
                if (savedAvatar) {
                    document.getElementById('profileAvatar').innerHTML = `<img src="${savedAvatar}" alt="å¤´åƒ" style="width:100%;height:100%;object-fit:cover;object-position:center;border-radius:50%;">`;
                }
            }

            // æ‰“å¼€å¤©æ°”é€‰æ‹©å¼¹çª—
            function openWeatherModal() {
                document.getElementById('weatherModal').classList.add('active');
            }

            // å…³é—­å¤©æ°”é€‰æ‹©å¼¹çª—
            function closeWeatherModal() {
                document.getElementById('weatherModal').classList.remove('active');
            }

            // é€‰æ‹©åŸå¸‚
            function selectCity(city) {
                document.getElementById('cityInput').value = city;
                // éšè—æœç´¢ç»“æœ
                document.getElementById('searchResults').style.display = 'none';
            }

            // æœç´¢åŸå¸‚
            function searchCities() {
                const searchTerm = document.getElementById('citySearchInput').value.trim();
                const searchResults = document.getElementById('searchResults');
                
                // å¦‚æœæœç´¢è¯ä¸ºç©ºï¼Œéšè—æœç´¢ç»“æœ
                if (!searchTerm) {
                    searchResults.style.display = 'none';
                    return;
                }
                
                // æ˜¾ç¤ºæœç´¢ç»“æœå®¹å™¨
                searchResults.style.display = 'block';
                
                // æ¨¡æ‹ŸåŸå¸‚æœç´¢ç»“æœï¼ˆå®é™…åº”ç”¨ä¸­åº”è¯¥è°ƒç”¨APIï¼‰
                const commonCities = [
                    'åŒ—äº¬', 'ä¸Šæµ·', 'å¹¿å·', 'æ·±åœ³', 'æ­å·', 'æˆéƒ½',
                    'çº½çº¦', 'ä¼¦æ•¦', 'ä¸œäº¬', 'å·´é»', 'æ‚‰å°¼', 'è«æ–¯ç§‘',
                    'æ´›æ‰çŸ¶', 'èŠåŠ å“¥', 'æ—§é‡‘å±±', 'å¤šä¼¦å¤š', 'æ¸©å“¥å',
                    'æ–°åŠ å¡', 'é¦–å°”', 'æ›¼è°·', 'è¿ªæ‹œ', 'å¼€ç½—', 'å¾·é‡Œ',
                    'å­Ÿä¹°', 'é›…åŠ è¾¾', 'å‰éš†å¡', 'é©¬å°¼æ‹‰', 'èƒ¡å¿—æ˜å¸‚',
                    'æŸæ—', 'æ³•å…°å…‹ç¦', 'æ…•å°¼é»‘', 'ç½—é©¬', 'ç±³å…°', 'é©¬å¾·é‡Œ',
                    'å·´å¡ç½—é‚£', 'é˜¿å§†æ–¯ç‰¹ä¸¹', 'å¸ƒé²å¡å°”', 'ç»´ä¹Ÿçº³', 'è‹é»ä¸–',
                    'æ–¯å¾·å“¥å°”æ‘©', 'å¥¥æ–¯é™†', 'èµ«å°”è¾›åŸº', 'å“¥æœ¬å“ˆæ ¹',
                    'ä¼Šæ–¯å¦å¸ƒå°”', 'åˆ©é›…å¾—', 'ç‰¹æ‹‰ç»´å¤«', 'çº¦ç¿°å†…æ–¯å ¡'
                ];
                
                // è¿‡æ»¤åŒ¹é…çš„åŸå¸‚
                const filteredCities = commonCities.filter(city => 
                    city.toLowerCase().includes(searchTerm.toLowerCase())
                );
                
                // æ˜¾ç¤ºæœç´¢ç»“æœ
                if (filteredCities.length > 0) {
                    let resultsHTML = '';
                    filteredCities.forEach(city => {
                        resultsHTML += `<div class="search-result-item" onclick="selectCity('${city}')" style="padding: 10px; cursor: pointer; border-bottom: 1px solid rgba(255,255,255,0.1);">${city}</div>`;
                    });
                    searchResults.innerHTML = resultsHTML;
                } else {
                    searchResults.innerHTML = '<div class="search-result-item" style="padding: 10px; color: #aaa;">æœªæ‰¾åˆ°åŒ¹é…çš„åŸå¸‚</div>';
                }
            }

            // æ ¹æ®åŸå¸‚æ›´æ–°å¤©æ°”
            function updateWeatherByCity() {
                const city = document.getElementById('cityInput').value.trim();
                if (city) {
                    // æ›´æ–°åŸå¸‚åç§°
                    document.getElementById('weatherLocation').textContent = city;
                    
                    // ä¿å­˜åŸå¸‚åˆ°æœ¬åœ°å­˜å‚¨
                    localStorage.setItem('weatherCity', city);
                    
                    // è·å–çœŸå®å¤©æ°”æ•°æ®
                    getRealWeatherData(city);
                    
                    // å…³é—­å¼¹çª—
                    closeWeatherModal();
                } else {
                    alert('è¯·è¾“å…¥åŸå¸‚åç§°');
                }
            }

            // è·å–çœŸå®å¤©æ°”æ•°æ®
            function getRealWeatherData(city) {
                // è·å–ç”¨æˆ·é…ç½®çš„WeatherAPIå¯†é’¥ï¼Œå¦‚æœæ²¡æœ‰åˆ™ä½¿ç”¨é»˜è®¤å¯†é’¥
                const userApiKey = localStorage.getItem('weatherApiKey');
                const apiKey = userApiKey || '37431093e55945bdb9b114902251810';
                
                // ä½¿ç”¨ WeatherAPI çš„å…è´¹ç«¯ç‚¹ (éœ€è¦ç½‘ç»œè®¿é—®)
                // æ³¨æ„ï¼šè¿™éœ€è¦è®¾å¤‡èƒ½è®¿é—®äº’è”ç½‘
                const url = `https://api.weatherapi.com/v1/current.json?key=${apiKey}&q=${encodeURIComponent(city)}&lang=zh`;
                
                fetch(url)
                    .then(response => {
                        if (!response.ok) {
                            // å¦‚æœAPIè°ƒç”¨å¤±è´¥ï¼Œæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
                            throw new Error('å¤©æ°”APIè°ƒç”¨å¤±è´¥');
                        }
                        return response.json();
                    })
                    .then(data => {
                        // å¤„ç†å¤©æ°”æ•°æ®
                        processWeatherAPIData(data);
                    })
                    .catch(error => {
                        console.error('è·å–å¤©æ°”æ•°æ®æ—¶å‡ºé”™:', error);
                        // å¦‚æœAPIè°ƒç”¨å¤±è´¥ï¼Œæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
                        alert('è·å–å¤©æ°”æ•°æ®å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–ç¨åé‡è¯•');
                    });
            }

            // å¤„ç† WeatherAPI è¿”å›çš„æ•°æ®
            function processWeatherAPIData(data) {
                try {
                    // ä»WeatherAPIè§£ææ•°æ®
                    const weatherDesc = data.current.condition.text;
                    // ä½¿ç”¨æ‘„æ°æ¸©åº¦å¹¶ç¡®ä¿æ­£ç¡®å¤„ç†ï¼Œç›´æ¥å–æ•´æ•°éƒ¨åˆ†
                    const temp = Math.trunc(data.current.temp_c);
                    
                    // ç¡®å®šå¤©æ°”ç±»å‹ - ä½¿ç”¨æ›´å‡†ç¡®çš„åˆ¤æ–­é€»è¾‘
                    let weatherType = 'sunny';
                    
                    // æ ¹æ®å¤©æ°”æè¿°æ–‡æœ¬åˆ¤æ–­å¤©æ°”ç±»å‹
                    if (weatherDesc.includes('é›·') || weatherDesc.includes('æš´')) {
                        weatherType = 'rainy';  // é›·é›¨å¤©æ°”
                    } else if (weatherDesc.includes('é›¨')) {
                        weatherType = 'rainy';  // é›¨å¤©
                    } else if (weatherDesc.includes('é›ª')) {
                        weatherType = 'snowy';  // é›ªå¤©
                    } else if (weatherDesc.includes('é›¾') || weatherDesc.includes('éœ¾')) {
                        weatherType = 'cloudy';  // é›¾éœ¾å¤©æ°”
                    } else if (weatherDesc.includes('é˜´') || weatherDesc.includes('å¤šäº‘') || weatherDesc.includes('äº‘')) {
                        weatherType = 'cloudy';  // é˜´å¤©æˆ–å¤šäº‘
                    } else if (weatherDesc.includes('æ™´')) {
                        weatherType = 'sunny';  // æ™´å¤©
                    }
                    
                    // ç‰¹æ®Šå¤„ç†ï¼šéƒ¨åˆ†æè¿°å¯èƒ½éœ€è¦æ›´ç»†è‡´çš„åˆ¤æ–­
                    if (weatherDesc === 'å¤šäº‘' || weatherDesc === 'é˜´') {
                        weatherType = 'cloudy';
                    } else if (weatherDesc.includes('å±€éƒ¨å¤šäº‘') || weatherDesc.includes('æ™´é—´å¤šäº‘')) {
                        weatherType = 'partlyCloudy';  // æ™´è½¬å¤šäº‘
                    }
                    
                    // æå–å¤©æ°”ä¿¡æ¯
                    const weather = {
                        type: weatherType,
                        description: weatherDesc,
                        temp: temp,
                        timestamp: new Date().toISOString()
                    };
                    
                    // æ›´æ–°å¤©æ°”æ˜¾ç¤º
                    updateWeatherDisplay(weather);
                    
                    // ä¿å­˜å¤©æ°”æ•°æ®åˆ°æœ¬åœ°å­˜å‚¨
                    localStorage.setItem('weatherData', JSON.stringify(weather));
                } catch (e) {
                    console.error('å¤„ç†WeatherAPIæ•°æ®æ—¶å‡ºé”™:', e);
                    // å¦‚æœè§£æå¤±è´¥ï¼Œæ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
                    alert('å¤©æ°”æ•°æ®è§£æå¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
                }
            }

            // ç§»é™¤äº†æ¨¡æ‹Ÿå¤©æ°”æ•°æ®åŠŸèƒ½ï¼Œåªä½¿ç”¨çœŸå®å¤©æ°”API

            // æ›´æ–°å¤©æ°”æ˜¾ç¤º
            function updateWeatherDisplay(weather) {
                // éšè—æ‰€æœ‰å¤©æ°”å›¾æ ‡
                document.getElementById('sunnyIcon').style.display = 'none';
                document.getElementById('rainyIcon').style.display = 'none';
                document.getElementById('cloudyIcon').style.display = 'none';
                document.getElementById('snowyIcon').style.display = 'none';
                document.getElementById('partlyCloudyIcon').style.display = 'none';
                document.getElementById('sleetIcon').style.display = 'none';
                document.getElementById('defaultWeatherIcon').style.display = 'none';
                
                // æ ¹æ®å¤©æ°”ç±»å‹æ˜¾ç¤ºå¯¹åº”å›¾æ ‡
                switch(weather.type) {
                    case 'sunny':
                        document.getElementById('sunnyIcon').style.display = 'block';
                        break;
                    case 'rainy':
                        document.getElementById('rainyIcon').style.display = 'block';
                        break;
                    case 'cloudy':
                        document.getElementById('cloudyIcon').style.display = 'block';
                        break;
                    case 'snowy':
                        document.getElementById('snowyIcon').style.display = 'block';
                        break;
                    case 'partlyCloudy':
                        document.getElementById('partlyCloudyIcon').style.display = 'block';
                        break;
                    case 'sleet':
                        document.getElementById('sleetIcon').style.display = 'block';
                        break;
                    default:
                        document.getElementById('defaultWeatherIcon').style.display = 'block';
                }
                
                // æ›´æ–°æ¸©åº¦å’Œæè¿°
                document.getElementById('weatherTemp').textContent = `${weather.temp}Â°C`;
                document.getElementById('weatherDescription').textContent = weather.description;
                
                // ä¿å­˜å¤©æ°”æ•°æ®åˆ°æœ¬åœ°å­˜å‚¨
                localStorage.setItem('weatherData', JSON.stringify({
                    type: weather.type,
                    temp: weather.temp,
                    description: weather.description,
                    timestamp: new Date().toISOString()
                }));
            }

            // åŠ è½½ä¿å­˜çš„å¤©æ°”æ•°æ®
            function loadWeatherData() {
                const savedCity = localStorage.getItem('weatherCity');
                const savedWeatherData = localStorage.getItem('weatherData');
                
                if (savedCity) {
                    document.getElementById('weatherLocation').textContent = savedCity;
                }
                
                if (savedWeatherData) {
                    try {
                        const weatherData = JSON.parse(savedWeatherData);
                        // æ£€æŸ¥æ•°æ®æ˜¯å¦è¿‡æœŸï¼ˆè¶…è¿‡1å°æ—¶ï¼‰
                        const now = new Date();
                        const savedTime = new Date(weatherData.timestamp);
                        const timeDiff = now - savedTime;
                        
                        if (timeDiff < 3600000) { // 1å°æ—¶å†…
                            updateWeatherDisplay(weatherData);
                        } else {
                            // æ•°æ®è¿‡æœŸï¼Œé‡æ–°è·å–
                            if (savedCity) {
                                getRealWeatherData(savedCity);
                            }
                        }
                    } catch (e) {
                        console.error('è§£æå¤©æ°”æ•°æ®æ—¶å‡ºé”™:', e);
                    }
                }
            }

            // å¤©æ°”çŠ¶æ€æ§åˆ¶å‡½æ•°ï¼ˆä¿æŒå‘åå…¼å®¹ï¼‰
            function setWeatherState(state) {
                // éšè—æ‰€æœ‰å¤©æ°”å›¾æ ‡
                document.getElementById('sunnyIcon').style.display = 'none';
                document.getElementById('rainyIcon').style.display = 'none';
                document.getElementById('cloudyIcon').style.display = 'none';
                document.getElementById('snowyIcon').style.display = 'none';
                document.getElementById('partlyCloudyIcon').style.display = 'none';
                document.getElementById('sleetIcon').style.display = 'none';
                document.getElementById('defaultWeatherIcon').style.display = 'none';
                
                // æ ¹æ®çŠ¶æ€æ˜¾ç¤ºå¯¹åº”å›¾æ ‡
                switch(state) {
                    case 'sunny':
                        document.getElementById('sunnyIcon').style.display = 'block';
                        break;
                    case 'rainy':
                        document.getElementById('rainyIcon').style.display = 'block';
                        break;
                    case 'cloudy':
                        document.getElementById('cloudyIcon').style.display = 'block';
                        break;
                    case 'snowy':
                        document.getElementById('snowyIcon').style.display = 'block';
                        break;
                    case 'partlyCloudy':
                        document.getElementById('partlyCloudyIcon').style.display = 'block';
                        break;
                    case 'sleet':
                        document.getElementById('sleetIcon').style.display = 'block';
                        break;
                    default:
                        document.getElementById('defaultWeatherIcon').style.display = 'block';
                }
                
                // ä¿å­˜å½“å‰å¤©æ°”çŠ¶æ€åˆ°æœ¬åœ°å­˜å‚¨
                localStorage.setItem('weatherState', state);
            }

            // åˆ‡æ¢å¤©æ°”çŠ¶æ€ï¼ˆä¿æŒå‘åå…¼å®¹ï¼‰
            function toggleWeatherState() {
                // ä¸å†ä½¿ç”¨æ—§çš„åˆ‡æ¢é€»è¾‘ï¼Œè€Œæ˜¯æ‰“å¼€å¤©æ°”é€‰æ‹©å¼¹çª—
                openWeatherModal();
            }

            // æ‰“å¼€çºªå¿µæ—¥è®¾ç½®å¼¹çª—
            function openDaysModal() {
                // åˆ›å»ºå¼¹çª—å…ƒç´ 
                const modal = document.createElement('div');
                modal.className = 'modal days-modal active';
                modal.style.zIndex = '2000';
                
                // è·å–å·²ä¿å­˜çš„çºªå¿µæ—¥æ•°æ®
                const savedDaysData = localStorage.getItem('romanticDaysData');
                let startDate = '';
                let isCountdown = false;
                
                if (savedDaysData) {
                    try {
                        const data = JSON.parse(savedDaysData);
                        startDate = data.startDate;
                        isCountdown = data.isCountdown;
                    } catch (e) {
                        console.error('è§£æçºªå¿µæ—¥æ•°æ®æ—¶å‡ºé”™:', e);
                    }
                }
                
                modal.innerHTML = `
                    <div class="modal-content" style="max-width: 300px;">
                        <div class="modal-header">
                            <div class="modal-title">è®¾ç½®çºªå¿µæ—¥</div>
                            <button class="close-btn" onclick="this.closest('.modal').remove()">&times;</button>
                        </div>
                        <div class="form-group">
                            <label class="form-label">é€‰æ‹©æ—¥æœŸç±»å‹</label>
                            <div style="display: flex; gap: 10px; margin-top: 10px;">
                                <button class="submit-btn" style="flex: 1; padding: 8px;" id="positiveBtn" 
                                    ${!isCountdown ? 'style="background: #007AFF;"' : ''}>æ­£æ•°æ—¥</button>
                                <button class="submit-btn" style="flex: 1; padding: 8px;" id="countdownBtn" 
                                    ${isCountdown ? 'style="background: #007AFF;"' : ''}>å€’æ•°æ—¥</button>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="form-label">é€‰æ‹©æ—¥æœŸ</label>
                            <input type="date" class="form-input" id="daysDate" value="${startDate}">
                        </div>
                        <button class="submit-btn" id="saveDaysBtn">ä¿å­˜</button>
                    </div>
                `;
                
                // æ·»åŠ åˆ°é¡µé¢
                document.body.appendChild(modal);
                
                // è®¾ç½®æŒ‰é’®äº‹ä»¶å¤„ç†ç¨‹åº
                let selectedType = isCountdown ? 'countdown' : 'positive';
                
                document.getElementById('positiveBtn').onclick = function() {
                    selectedType = 'positive';
                    this.style.background = '#007AFF';
                    document.getElementById('countdownBtn').style.background = '';
                };
                
                document.getElementById('countdownBtn').onclick = function() {
                    selectedType = 'countdown';
                    this.style.background = '#007AFF';
                    document.getElementById('positiveBtn').style.background = '';
                };
                
                document.getElementById('saveDaysBtn').onclick = function() {
                    const selectedDate = document.getElementById('daysDate').value;
                    if (selectedDate) {
                        // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                        const daysData = {
                            startDate: selectedDate,
                            isCountdown: selectedType === 'countdown'
                        };
                        localStorage.setItem('romanticDaysData', JSON.stringify(daysData));
                        
                        // æ›´æ–°æ˜¾ç¤º
                        updateDaysDisplay();
                        
                        // å…³é—­å¼¹çª—
                        document.querySelector('.days-modal').remove();
                    } else {
                        alert('è¯·é€‰æ‹©æ—¥æœŸ');
                    }
                };
            }
            
            // æ›´æ–°å¤©æ•°æ˜¾ç¤º
            function updateDaysDisplay() {
                const daysDisplay = document.getElementById('daysCount');
                const savedDaysData = localStorage.getItem('romanticDaysData');
                
                if (savedDaysData) {
                    try {
                        const data = JSON.parse(savedDaysData);
                        const startDate = new Date(data.startDate);
                        const today = new Date();
                        
                        // è®¡ç®—å¤©æ•°å·®
                        const timeDiff = Math.abs(today.getTime() - startDate.getTime());
                        const daysDiff = Math.ceil(timeDiff / (1000 * 3600 * 24));
                        
                        // æ˜¾ç¤ºå¤©æ•°
                        if (data.isCountdown) {
                            daysDisplay.textContent = `è¿˜æœ‰${daysDiff}å¤©`;
                        } else {
                            daysDisplay.textContent = `å·²ç»${daysDiff}å¤©`;
                        }
                        
                        // æ·»åŠ å‘å…‰æ•ˆæœ
                        daysDisplay.classList.add('glow');
                    } catch (e) {
                        console.error('è§£æçºªå¿µæ—¥æ•°æ®æ—¶å‡ºé”™:', e);
                        daysDisplay.textContent = 'ç‚¹å‡»è®¾ç½®çºªå¿µæ—¥';
                        daysDisplay.classList.remove('glow');
                    }
                } else {
                    daysDisplay.textContent = 'ç‚¹å‡»è®¾ç½®çºªå¿µæ—¥';
                    daysDisplay.classList.remove('glow');
                }
            }
            
            // æ›´æ¢å¤´åƒ
            function changeAvatar() {
                // åˆ›å»ºæ–‡ä»¶è¾“å…¥å…ƒç´ 
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'image/*';
                input.onchange = function(event) {
                    const file = event.target.files[0];
                    if (file) {
                        // æ£€æŸ¥æ–‡ä»¶å¤§å°ï¼ˆæ— é™åˆ¶ï¼‰
                        // if (file.size > 5 * 1024 * 1024) {
                        //     alert('å›¾ç‰‡æ–‡ä»¶å¤ªå¤§ï¼Œè¯·é€‰æ‹©å°äº5MBçš„å›¾ç‰‡');
                        //     return;
                        // }
                        
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            try {
                                // æ›´æ–°å¤´åƒæ˜¾ç¤ºï¼Œç¡®ä¿æ­£ç¡®æ¯”ä¾‹
                                document.getElementById('profileAvatar').innerHTML = `<img src="${e.target.result}" alt="å¤´åƒ" style="width:100%;height:100%;object-fit:cover;object-position:center;border-radius:50%;">`;
                                // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                                localStorage.setItem('profileAvatar', e.target.result);
                            } catch (error) {
                                console.error('ä¿å­˜å¤´åƒæ—¶å‡ºé”™:', error);
                                // æ£€æŸ¥æ˜¯å¦æ˜¯å­˜å‚¨ç©ºé—´ä¸è¶³é”™è¯¯
                                if (error.name === 'QuotaExceededError' || error.code === 22) {
                                    alert('å­˜å‚¨ç©ºé—´ä¸è¶³ï¼Œæ— æ³•ä¿å­˜å¤´åƒã€‚è¯·æ¸…ç†å­˜å‚¨ç©ºé—´åé‡è¯•ã€‚');
                                } else {
                                    alert('ä¿å­˜å¤´åƒå¤±è´¥ï¼Œè¯·é‡è¯•');
                                }
                            }
                        };
                        reader.onerror = function() {
                            alert('è¯»å–å›¾ç‰‡æ–‡ä»¶æ—¶å‡ºé”™ï¼Œè¯·é‡è¯•');
                        };
                        reader.readAsDataURL(file);
                    }
                };
                input.click();
            }

            // æ·»åŠ æ›´æ¢å¤´åƒçš„å‡½æ•°
            function changeAvatar(side) {
                // åˆ›å»ºæ–‡ä»¶è¾“å…¥å…ƒç´ 
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'image/*';
                input.onchange = function(event) {
                    const file = event.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            // åˆ›å»ºå¤´åƒå›¾ç‰‡å…ƒç´ 
                            const avatarImg = document.createElement('img');
                            avatarImg.src = e.target.result;
                            avatarImg.alt = 'å¤´åƒ';
                            // æ·»åŠ æ ·å¼ç¡®ä¿å¤´åƒæ­£ç¡®æ˜¾ç¤º
                            avatarImg.style.width = '100%';
                            avatarImg.style.height = '100%';
                            avatarImg.style.objectFit = 'cover';
                            avatarImg.style.objectPosition = 'center';
                            avatarImg.style.borderRadius = '50%';
                            
                            // æ›´æ–°å¯¹åº”ä¾§çš„å¤´åƒæ˜¾ç¤º
                            if (side === 'left') {
                                const avatarContainer = document.getElementById('avatarLeft');
                                if (avatarContainer) {
                                    avatarContainer.innerHTML = '';
                                    avatarContainer.appendChild(avatarImg);
                                    // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                                    try {
                                        localStorage.setItem('romanticAvatarLeft', e.target.result);
                                        console.log('å·¦ä¾§å¤´åƒå·²ä¿å­˜');
                                    } catch (error) {
                                        console.error('ä¿å­˜å·¦ä¾§å¤´åƒæ—¶å‡ºé”™:', error);
                                        // æ£€æŸ¥æ˜¯å¦æ˜¯å­˜å‚¨ç©ºé—´ä¸è¶³é”™è¯¯
                                        if (error.name === 'QuotaExceededError' || error.code === 22) {
                                            alert('å­˜å‚¨ç©ºé—´ä¸è¶³ï¼Œæ— æ³•ä¿å­˜å·¦ä¾§å¤´åƒã€‚è¯·æ¸…ç†å­˜å‚¨ç©ºé—´åé‡è¯•ã€‚');
                                        } else {
                                            alert('ä¿å­˜å·¦ä¾§å¤´åƒå¤±è´¥ï¼Œè¯·é‡è¯•');
                                        }
                                    }
                                } else {
                                    console.error('æœªæ‰¾åˆ°å·¦ä¾§å¤´åƒå®¹å™¨');
                                }
                            } else if (side === 'right') {
                                const avatarContainer = document.getElementById('avatarRight');
                                if (avatarContainer) {
                                    avatarContainer.innerHTML = '';
                                    avatarContainer.appendChild(avatarImg);
                                    // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                                    try {
                                        localStorage.setItem('romanticAvatarRight', e.target.result);
                                        console.log('å³ä¾§å¤´åƒå·²ä¿å­˜');
                                    } catch (error) {
                                        console.error('ä¿å­˜å³ä¾§å¤´åƒæ—¶å‡ºé”™:', error);
                                        // æ£€æŸ¥æ˜¯å¦æ˜¯å­˜å‚¨ç©ºé—´ä¸è¶³é”™è¯¯
                                        if (error.name === 'QuotaExceededError' || error.code === 22) {
                                            alert('å­˜å‚¨ç©ºé—´ä¸è¶³ï¼Œæ— æ³•ä¿å­˜å³ä¾§å¤´åƒã€‚è¯·æ¸…ç†å­˜å‚¨ç©ºé—´åé‡è¯•ã€‚');
                                        } else {
                                            alert('ä¿å­˜å³ä¾§å¤´åƒå¤±è´¥ï¼Œè¯·é‡è¯•');
                                        }
                                    }
                                } else {
                                    console.error('æœªæ‰¾åˆ°å³ä¾§å¤´åƒå®¹å™¨');
                                }
                            }
                        };
                        reader.onerror = function() {
                            alert('è¯»å–å›¾ç‰‡æ–‡ä»¶æ—¶å‡ºé”™ï¼Œè¯·é‡è¯•');
                        };
                        reader.readAsDataURL(file);
                    }
                };
                input.click();
            }
            
            // æ·»åŠ æ›´æ¢è¯­éŸ³å¤´åƒçš„å‡½æ•°
            function changeVoiceAvatar() {
                // åˆ›å»ºæ–‡ä»¶è¾“å…¥å…ƒç´ 
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'image/*';
                input.onchange = function(event) {
                    const file = event.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            // æ›´æ–°è¯­éŸ³å¤´åƒæ˜¾ç¤º
                            const avatarImg = document.getElementById('voiceAvatarImg');
                            const avatarPlaceholder = document.getElementById('voiceAvatarPlaceholder');
                            avatarImg.src = e.target.result;
                            avatarImg.style.display = 'block';
                            avatarPlaceholder.style.display = 'none';
                            // ä¿å­˜åˆ°æœ¬åœ°å­˜å‚¨
                            try {
                                localStorage.setItem('voiceAvatar', e.target.result);
                            } catch (error) {
                                console.error('ä¿å­˜è¯­éŸ³å¤´åƒæ—¶å‡ºé”™:', error);
                                // æ£€æŸ¥æ˜¯å¦æ˜¯å­˜å‚¨ç©ºé—´ä¸è¶³é”™è¯¯
                                if (error.name === 'QuotaExceededError' || error.code === 22) {
                                    alert('å­˜å‚¨ç©ºé—´ä¸è¶³ï¼Œæ— æ³•ä¿å­˜è¯­éŸ³å¤´åƒã€‚è¯·æ¸…ç†å­˜å‚¨ç©ºé—´åé‡è¯•ã€‚');
                                } else {
                                    alert('ä¿å­˜è¯­éŸ³å¤´åƒå¤±è´¥ï¼Œè¯·é‡è¯•');
                                }
                            }
                        };
                        reader.onerror = function() {
                            alert('è¯»å–å›¾ç‰‡æ–‡ä»¶æ—¶å‡ºé”™ï¼Œè¯·é‡è¯•');
                        };
                        reader.readAsDataURL(file);
                    }
                };
                input.click();
            }
            
            // åŠ è½½ä¿å­˜çš„è¯­éŸ³å¤´åƒ
            function loadVoiceAvatar() {
                const savedAvatar = localStorage.getItem('voiceAvatar');
                if (savedAvatar) {
                    const avatarImg = document.getElementById('voiceAvatarImg');
                    const avatarPlaceholder = document.getElementById('voiceAvatarPlaceholder');
                    avatarImg.src = savedAvatar;
                    avatarImg.style.display = 'block';
                    avatarPlaceholder.style.display = 'none';
                }
            }
            
            // åŠ è½½ä¿å­˜çš„å¤´åƒ
            function loadRomanticAvatars() {
                console.log('å¼€å§‹åŠ è½½æµªæ¼«å¤´åƒ');
                
                // åŠ è½½å·¦ä¾§å¤´åƒ
                const savedAvatarLeft = localStorage.getItem('romanticAvatarLeft');
                console.log('å·¦ä¾§å¤´åƒæ•°æ®:', savedAvatarLeft ? 'å·²ä¿å­˜' : 'æœªä¿å­˜');
                
                if (savedAvatarLeft) {
                    const avatarContainer = document.getElementById('avatarLeft');
                    if (avatarContainer) {
                        avatarContainer.innerHTML = '';
                        const avatarImg = document.createElement('img');
                        avatarImg.src = savedAvatarLeft;
                        avatarImg.alt = 'å¤´åƒ';
                        // æ·»åŠ æ ·å¼ç¡®ä¿å¤´åƒæ­£ç¡®æ˜¾ç¤º
                        avatarImg.style.width = '100%';
                        avatarImg.style.height = '100%';
                        avatarImg.style.objectFit = 'cover';
                        avatarImg.style.objectPosition = 'center';
                        avatarImg.style.borderRadius = '50%';
                        avatarContainer.appendChild(avatarImg);
                        console.log('å·¦ä¾§å¤´åƒåŠ è½½æˆåŠŸ');
                    } else {
                        console.error('æœªæ‰¾åˆ°å·¦ä¾§å¤´åƒå®¹å™¨');
                    }
                }
                
                // åŠ è½½å³ä¾§å¤´åƒ
                const savedAvatarRight = localStorage.getItem('romanticAvatarRight');
                console.log('å³ä¾§å¤´åƒæ•°æ®:', savedAvatarRight ? 'å·²ä¿å­˜' : 'æœªä¿å­˜');
                
                if (savedAvatarRight) {
                    const avatarContainer = document.getElementById('avatarRight');
                    if (avatarContainer) {
                        avatarContainer.innerHTML = '';
                        const avatarImg = document.createElement('img');
                        avatarImg.src = savedAvatarRight;
                        avatarImg.alt = 'å¤´åƒ';
                        // æ·»åŠ æ ·å¼ç¡®ä¿å¤´åƒæ­£ç¡®æ˜¾ç¤º
                        avatarImg.style.width = '100%';
                        avatarImg.style.height = '100%';
                        avatarImg.style.objectFit = 'cover';
                        avatarImg.style.objectPosition = 'center';
                        avatarImg.style.borderRadius = '50%';
                        avatarContainer.appendChild(avatarImg);
                        console.log('å³ä¾§å¤´åƒåŠ è½½æˆåŠŸ');
                    } else {
                        console.error('æœªæ‰¾åˆ°å³ä¾§å¤´åƒå®¹å™¨');
                    }
                }
                
                // æ›´æ–°å¤©æ•°æ˜¾ç¤º
                updateDaysDisplay();
            }
            
            // ä¸Šä¼ è¯­éŸ³éŸ³é¢‘æ–‡ä»¶
            function uploadVoiceAudio() {
                // åˆ›å»ºæ–‡ä»¶è¾“å…¥å…ƒç´ 
                const input = document.createElement('input');
                input.type = 'file';
                input.accept = 'audio/*';
                input.onchange = function(event) {
                    const file = event.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function(e) {
                            // ä¿å­˜éŸ³é¢‘æ•°æ®åˆ°æœ¬åœ°å­˜å‚¨
                            localStorage.setItem('voiceAudio', e.target.result);
                            localStorage.setItem('voiceAudioName', file.name);
                            // æ˜¾ç¤ºæç¤ºä¿¡æ¯
                            alert('è¯­éŸ³éŸ³é¢‘å·²ä¸Šä¼ æˆåŠŸï¼');
                        };
                        reader.readAsDataURL(file);
                    }
                };
                input.click();
            }
            
            // æ’­æ”¾è¯­éŸ³éŸ³é¢‘
            let voiceAudio = null; // å…¨å±€éŸ³é¢‘å¯¹è±¡
            let isVoicePlaying = false; // æ’­æ”¾çŠ¶æ€æ ‡å¿—
            
            function playVoiceAudio() {
                const voiceAudioData = localStorage.getItem('voiceAudio');
                if (voiceAudioData) {
                    // å¦‚æœè¿˜æ²¡æœ‰åˆ›å»ºéŸ³é¢‘å¯¹è±¡ï¼Œåˆ™åˆ›å»ºä¸€ä¸ª
                    if (!voiceAudio) {
                        voiceAudio = new Audio(voiceAudioData);
                        
                        // ç›‘å¬æ’­æ”¾ç»“æŸäº‹ä»¶
                        voiceAudio.addEventListener('ended', function() {
                            isVoicePlaying = false;
                            // æ¢å¤æ³¢çº¹åŠ¨ç”»
                            const waveBars = document.querySelectorAll('.wave-bar');
                            waveBars.forEach(bar => {
                                bar.style.animation = 'waveAnimation 1s infinite ease-in-out';
                            });
                        });
                    }
                    
                    // åˆ‡æ¢æ’­æ”¾/æš‚åœçŠ¶æ€
                    if (isVoicePlaying) {
                        // å½“å‰æ­£åœ¨æ’­æ”¾ï¼Œéœ€è¦æš‚åœ
                        voiceAudio.pause();
                        isVoicePlaying = false;
                        // æ¢å¤æ³¢çº¹åŠ¨ç”»
                        const waveBars = document.querySelectorAll('.wave-bar');
                        waveBars.forEach(bar => {
                            bar.style.animation = 'waveAnimation 1s infinite ease-in-out';
                        });
                    } else {
                        // å½“å‰å·²æš‚åœæˆ–æœªæ’­æ”¾ï¼Œéœ€è¦æ’­æ”¾
                        voiceAudio.play().catch(e => {
                            console.error('æ’­æ”¾å¤±è´¥:', e);
                            alert('éŸ³é¢‘æ’­æ”¾å¤±è´¥ï¼Œè¯·é‡è¯•');
                        });
                        isVoicePlaying = true;
                        // åŠ å¿«æ³¢çº¹åŠ¨ç”»
                        const waveBars = document.querySelectorAll('.wave-bar');
                        waveBars.forEach(bar => {
                            bar.style.animation = 'waveAnimation 0.5s infinite ease-in-out';
                        });
                    }
                } else {
                    alert('è¯·å…ˆä¸Šä¼ éŸ³é¢‘æ–‡ä»¶');
                }
            }

            // ========= æ»‘åŠ¨é¡µé¢åŠŸèƒ½ç›¸å…³å‡½æ•° =========
            let currentPage = 0;
            let startX = 0;
            let startY = 0;
            let isSwiping = false;
            const pages = document.querySelectorAll('.page'); // è·å–æ‰€æœ‰é¡µé¢
            const page1 = document.getElementById('page1');
            const page2 = document.getElementById('page2');
            const page3 = document.getElementById('page3'); // æ·»åŠ ç¬¬ä¸‰é¡µ

            // è§¦æ‘¸å¼€å§‹äº‹ä»¶
            document.addEventListener('touchstart', function(e) {
                startX = e.touches[0].clientX;
                startY = e.touches[0].clientY;
                isSwiping = true;
            });

            // è§¦æ‘¸ç§»åŠ¨äº‹ä»¶
            document.addEventListener('touchmove', function(e) {
                if (!isSwiping) return;
                
                const currentX = e.touches[0].clientX;
                const currentY = e.touches[0].clientY;
                const diffX = currentX - startX;
                const diffY = currentY - startY;
                
                // åˆ¤æ–­æ˜¯å¦ä¸ºæ°´å¹³æ»‘åŠ¨
                if (Math.abs(diffX) > Math.abs(diffY)) {
                    e.preventDefault();
                    
                    // æ ¹æ®å½“å‰é¡µé¢å’Œæ»‘åŠ¨æ–¹å‘æ›´æ–°ä½ç½®
                    if (currentPage === 0 && diffX < 0) {
                        // ç¬¬ä¸€é¡µå‘å·¦æ»‘åŠ¨åˆ°ç¬¬äºŒé¡µ
                        const movePercent = Math.max(0, Math.min(100, -diffX / window.innerWidth * 100));
                        page1.style.transform = `translateX(${-movePercent}%)`;
                        page2.style.transform = `translateX(${-movePercent + 100}%)`;
                        page3.style.transform = `translateX(100%)`;
                    } else if (currentPage === 1 && diffX > 0) {
                        // ç¬¬äºŒé¡µå‘å³æ»‘åŠ¨åˆ°ç¬¬ä¸€é¡µ
                        const movePercent = Math.max(0, Math.min(100, diffX / window.innerWidth * 100));
                        page1.style.transform = `translateX(${-100 + movePercent}%)`;
                        page2.style.transform = `translateX(${movePercent}%)`;
                        page3.style.transform = `translateX(100%)`;
                    } else if (currentPage === 1 && diffX < 0) {
                        // ç¬¬äºŒé¡µå‘å·¦æ»‘åŠ¨åˆ°ç¬¬ä¸‰é¡µ
                        const movePercent = Math.max(0, Math.min(100, -diffX / window.innerWidth * 100));
                        page1.style.transform = `translateX(-100%)`;
                        page2.style.transform = `translateX(${-movePercent}%)`;
                        page3.style.transform = `translateX(${-movePercent + 100}%)`;
                    } else if (currentPage === 2 && diffX > 0) {
                        // ç¬¬ä¸‰é¡µå‘å³æ»‘åŠ¨åˆ°ç¬¬äºŒé¡µ
                        const movePercent = Math.max(0, Math.min(100, diffX / window.innerWidth * 100));
                        page1.style.transform = `translateX(-100%)`;
                        page2.style.transform = `translateX(${-100 + movePercent}%)`;
                        page3.style.transform = `translateX(${movePercent}%)`;
                    }
                }
            });

            // è§¦æ‘¸ç»“æŸäº‹ä»¶
            document.addEventListener('touchend', function(e) {
                if (!isSwiping) return;
                
                const endX = e.changedTouches[0].clientX;
                const diffX = endX - startX;
                const absDiffX = Math.abs(diffX);
                
                // åˆ¤æ–­æ˜¯å¦ä¸ºæœ‰æ•ˆçš„æ»‘åŠ¨
                if (absDiffX > 30) { // æ»‘åŠ¨è·ç¦»è¶…è¿‡30pxæ‰åˆ‡æ¢é¡µé¢
                    if (diffX < 0 && currentPage === 0) {
                        // å‘å·¦æ»‘åŠ¨åˆ°ç¬¬äºŒé¡µ
                        currentPage = 1;
                        page1.style.transform = 'translateX(-100%)';
                        page2.style.transform = 'translateX(0)';
                        page3.style.transform = 'translateX(100%)';
                    } else if (diffX > 0 && currentPage === 1) {
                        // å‘å³æ»‘åŠ¨åˆ°ç¬¬ä¸€é¡µ
                        currentPage = 0;
                        page1.style.transform = 'translateX(0)';
                        page2.style.transform = 'translateX(100%)';
                        page3.style.transform = 'translateX(100%)';
                    } else if (diffX < 0 && currentPage === 1) {
                        // å‘å·¦æ»‘åŠ¨åˆ°ç¬¬ä¸‰é¡µ
                        currentPage = 2;
                        page1.style.transform = 'translateX(-100%)';
                        page2.style.transform = 'translateX(-100%)';
                        page3.style.transform = 'translateX(0)';
                    } else if (diffX > 0 && currentPage === 2) {
                        // å‘å³æ»‘åŠ¨åˆ°ç¬¬äºŒé¡µ
                        currentPage = 1;
                        page1.style.transform = 'translateX(-100%)';
                        page2.style.transform = 'translateX(0)';
                        page3.style.transform = 'translateX(100%)';
                    }
                } else {
                    // æ»‘åŠ¨è·ç¦»ä¸å¤Ÿï¼Œå›åˆ°åŸä½ç½®
                    if (currentPage === 0) {
                        page1.style.transform = 'translateX(0)';
                        page2.style.transform = 'translateX(100%)';
                        page3.style.transform = 'translateX(100%)';
                    } else if (currentPage === 1) {
                        page1.style.transform = 'translateX(-100%)';
                        page2.style.transform = 'translateX(0)';
                        page3.style.transform = 'translateX(100%)';
                    } else {
                        page1.style.transform = 'translateX(-100%)';
                        page2.style.transform = 'translateX(-100%)';
                        page3.style.transform = 'translateX(0)';
                    }
                }
                
                isSwiping = false;
            });
                    
                    // ========= æ–°å¢å°ç»„ä»¶ç›¸å…³å‡½æ•° =========
                    
                    // æ›´æ–°å°ç»„ä»¶æ—¶é—´
                    function updateWidgetTime() {
                        const now = new Date();
                        const timeString = now.toLocaleTimeString('zh-CN', { hour: '2-digit', minute: '2-digit' });
                        document.getElementById('widgetTime').textContent = timeString;
                    }
                    
                    // æ›´æ¢çˆ±å¿ƒæ°”æ³¡æ–‡æœ¬
                    function changeLoveText() {
                        const text = prompt('è¯·è¾“å…¥æ–°çš„æ–‡æœ¬ï¼š', document.getElementById('loveBubble').textContent);
                        if (text !== null) {
                            document.getElementById('loveBubble').textContent = text;
                            localStorage.setItem('loveBubbleText', text);
                        }
                    }
                    
                    // æ›´æ¢å°ç»„ä»¶ç…§ç‰‡
                    function changeWidgetPhoto() {
                        const input = document.createElement('input');
                        input.type = 'file';
                        input.accept = 'image/*';
                        input.onchange = function(event) {
                            const file = event.target.files[0];
                            if (file) {
                                // ä¸Šä¼ åˆ°imgbb
                                uploadToImgBB(file, function(url) {
                                    if (url) {
                                        document.getElementById('widgetPhoto').src = url;
                                        document.getElementById('widgetPhoto').style.display = 'block';
                                        document.getElementById('photoPlaceholder').style.display = 'none';
                                        localStorage.setItem('widgetPhotoUrl', url);
                                    }
                                });
                            }
                        };
                        input.click();
                    }
                    
                    // ä¸Šä¼ åˆ°imgbb
                    function uploadToImgBB(file, callback) {
                        const formData = new FormData();
                        formData.append('image', file);
                        
                        // æ˜¾ç¤ºä¸Šä¼ æç¤º
                        showPageAlert('æ­£åœ¨ä¸Šä¼ ç…§ç‰‡...');
                        
                        // è·å–ç”¨æˆ·åœ¨è®¾ç½®é¡µé¢é…ç½®çš„imgbb APIå¯†é’¥
                        const apiKey = localStorage.getItem('imgbbApiKey') || 'YOUR_IMGBB_API_KEY'; // å¦‚æœæ²¡æœ‰é…ç½®ï¼Œåˆ™ä½¿ç”¨é»˜è®¤å¯†é’¥
                        
                        fetch(`https://api.imgbb.com/1/upload?key=${apiKey}`, {
                            method: 'POST',
                            body: formData
                        })
                        .then(response => response.json())
                        .then(data => {
                            if (data.success) {
                                showPageAlert('ç…§ç‰‡ä¸Šä¼ æˆåŠŸï¼');
                                callback(data.data.url);
                            } else {
                                showPageAlert('ç…§ç‰‡ä¸Šä¼ å¤±è´¥ï¼Œè¯·é‡è¯•');
                                callback(null);
                            }
                        })
                        .catch(error => {
                            console.error('ä¸Šä¼ é”™è¯¯:', error);
                            showPageAlert('ä¸Šä¼ å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥');
                            callback(null);
                        });
                    }
                    
                    // æ›´æ¢è¾“å…¥æ¡†æ–‡æœ¬
                    function changeWidgetInput() {
                        const inputValue = document.getElementById('widgetInput').value;
                        const text = prompt('è¯·è¾“å…¥æ–°çš„æ–‡æœ¬ï¼š', inputValue);
                        if (text !== null) {
                            document.getElementById('widgetInput').value = text;
                            localStorage.setItem('widgetInputText', text);
                        }
                    }
                    
                    // å‘é€æ¶ˆæ¯
                    function sendWidgetMessage() {
                        const message = document.getElementById('widgetInput').value;
                        if (message.trim() !== '') {
                            showPageAlert('æ¶ˆæ¯å·²å‘é€: ' + message);
                            // è¿™é‡Œå¯ä»¥æ·»åŠ å®é™…çš„å‘é€é€»è¾‘
                            document.getElementById('widgetInput').value = '';
                            localStorage.removeItem('widgetInputText');
                        } else {
                            showPageAlert('è¯·è¾“å…¥æ¶ˆæ¯å†…å®¹');
                        }
                    }
                    
                    // æ·»åŠ é¡¹ç›®
                    function addWidgetItem() {
                        showPageAlert('æ·»åŠ åŠŸèƒ½å·²è§¦å‘');
                        // è¿™é‡Œå¯ä»¥æ·»åŠ å®é™…çš„æ·»åŠ é€»è¾‘
                    }
                    
                    // åŠ è½½å°ç»„ä»¶æ•°æ®
                    function loadWidgetData() {
                        // åŠ è½½çˆ±å¿ƒæ°”æ³¡æ–‡æœ¬
                        const savedLoveText = localStorage.getItem('loveBubbleText');
                        if (savedLoveText) {
                            document.getElementById('loveBubble').textContent = savedLoveText;
                        }
                        
                        // åŠ è½½ç…§ç‰‡
                        const savedPhotoUrl = localStorage.getItem('widgetPhotoUrl');
                        if (savedPhotoUrl) {
                            document.getElementById('widgetPhoto').src = savedPhotoUrl;
                            document.getElementById('widgetPhoto').style.display = 'block';
                            document.getElementById('photoPlaceholder').style.display = 'none';
                        }
                        
                        // åŠ è½½è¾“å…¥æ¡†æ–‡æœ¬
                        const savedInputText = localStorage.getItem('widgetInputText');
                        if (savedInputText) {
                            document.getElementById('widgetInput').value = savedInputText;
                        }
                    }


            
        </script>
    </div>
</body>
</html>



